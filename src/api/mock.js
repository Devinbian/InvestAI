import Mock from "mockjs";

// æ¨¡æ‹Ÿè‚¡ç¥¨æ•°æ®
const stockList = Mock.mock({
  "list|10": [
    {
      "code|600000-603999": 1,
      name: "@cword(2,4)",
      "price|10-100.2": 1,
      "change|0-10.2": 1,
      "changePercent|0-10.2": 1,
      industry:
        '@pick(["ç§‘æŠ€", "é‡‘è", "åŒ»ç–—å¥åº·", "æ¶ˆè´¹", "èƒ½æº", "æˆ¿åœ°äº§", "åˆ¶é€ ä¸š", "å†œä¸š"])',
      "pe|0-100.2": 1,
      "pb|0-10.2": 1,
      "marketCap|100000000-10000000000": 1,
    },
  ],
}).list;

// æ¨¡æ‹Ÿå¯¹è¯å†å²
const chatHistory = [
  {
    role: "assistant",
    content:
      "æ‚¨å¥½ï¼æˆ‘æ˜¯æ‚¨çš„æ™ºèƒ½æŠ•èµ„åŠ©æ‰‹ã€‚æˆ‘å¯ä»¥å¸®æ‚¨åˆ†æè‚¡ç¥¨ã€æä¾›æŠ•èµ„å»ºè®®ï¼Œä»¥åŠå›ç­”æ‚¨çš„æŠ•èµ„ç›¸å…³é—®é¢˜ã€‚è¯·é—®æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®æ‚¨çš„å—ï¼Ÿ",
  },
];

// æ¨¡æ‹ŸAPIå“åº”
export const mockApi = {
  // è·å–è‚¡ç¥¨åˆ—è¡¨
  getStockList: () => {
    return Promise.resolve({
      code: 200,
      data: stockList,
      message: "success",
    });
  },

  // è·å–å¯¹è¯å†å²
  getChatHistory: () => {
    return Promise.resolve({
      code: 200,
      data: chatHistory,
      message: "success",
    });
  },

  // å‘é€æ¶ˆæ¯
  sendMessage: (message) => {
    // æ£€æŸ¥æ˜¯å¦æ˜¯è‚¡ç¥¨ç›¸å…³æŸ¥è¯¢
    const stockKeywords = [
      "è‚¡ç¥¨",
      "åˆ†æ",
      "å¹³å®‰é“¶è¡Œ",
      "äº”ç²®æ¶²",
      "ä¸‡ç§‘",
      "å®å¾·æ—¶ä»£",
      "èŒ…å°",
      "è…¾è®¯",
      "é˜¿é‡Œ",
      "æ¯”äºšè¿ª",
    ];
    const isStockQuery = stockKeywords.some((keyword) =>
      message.includes(keyword),
    );

    // æ£€æŸ¥æ˜¯å¦æ˜¯è´­ä¹°ç›¸å…³æŸ¥è¯¢
    const buyKeywords = ["è´­ä¹°", "ä¹°å…¥", "ä¹°", "ä¸‹å•"];
    const isBuyQuery = buyKeywords.some((keyword) => message.includes(keyword));

    // æ£€æŸ¥æ˜¯å¦æ˜¯é‡åŒ–ç›¸å…³æŸ¥è¯¢
    const quantKeywords = [
      "é‡åŒ–",
      "ç­–ç•¥",
      "å›æµ‹",
      "å› å­",
      "ç®—æ³•",
      "ä¿¡å·",
      "å¤šå› å­",
      "æŠ€æœ¯æŒ‡æ ‡",
      "å‡å€¼å›å½’",
      "åŠ¨é‡ç­–ç•¥",
      "é…å¯¹äº¤æ˜“",
      "å¤æ™®æ¯”ç‡",
      "æœ€å¤§å›æ’¤",
      "å¹´åŒ–æ”¶ç›Š",
      "äº¤æ˜“ä¿¡å·",
      "MACD",
      "RSI",
      "å¸ƒæ—å¸¦",
      "å‡çº¿äº¤å‰",
    ];
    const isQuantQuery = quantKeywords.some((keyword) =>
      message.includes(keyword),
    );

    let response;

    if (isBuyQuery) {
      // è´­ä¹°ç›¸å…³å“åº”
      const stockInfo = {
        code: "000001",
        name: "å¹³å®‰é“¶è¡Œ",
        price: "12.45",
        change: 0.23,
        changePercent: 1.88,
        industry: "é“¶è¡Œ",
        pe: 5.2,
        pb: 0.8,
        marketCap: 240000000000,
      };

      response = {
        role: "assistant",
        content: `æˆ‘ä¸ºæ‚¨æ‰¾åˆ°äº†${stockInfo.name}(${stockInfo.code})çš„äº¤æ˜“ä¿¡æ¯ï¼š

**å½“å‰ä»·æ ¼**ï¼šÂ¥${stockInfo.price}
**ä»Šæ—¥æ¶¨è·Œ**ï¼š${stockInfo.change > 0 ? "+" : ""}${stockInfo.change}(${stockInfo.changePercent > 0 ? "+" : ""}${stockInfo.changePercent}%)

æ‚¨å¯ä»¥é€šè¿‡ä¸‹æ–¹çš„è´­ä¹°æŒ‰é’®è¿›è¡Œäº¤æ˜“æ“ä½œã€‚å»ºè®®æ‚¨ï¼š
â€¢ æ ¹æ®è‡ªå·±çš„é£é™©æ‰¿å—èƒ½åŠ›ç¡®å®šè´­ä¹°æ•°é‡
â€¢ æ³¨æ„åˆ†æ•£æŠ•èµ„ï¼Œä¸è¦æŠŠæ‰€æœ‰èµ„é‡‘æŠ•å…¥å•ä¸€è‚¡ç¥¨
â€¢ å…³æ³¨å¸‚åœºåŠ¨æ€ï¼Œé€‚æ—¶è°ƒæ•´æŠ•èµ„ç­–ç•¥`,
        stockInfo: stockInfo,
        hasStockInfo: true,
        isBuyMode: true, // æ ‡è¯†è¿™æ˜¯è´­ä¹°æ¨¡å¼
      };
    } else if (isQuantQuery) {
      // é‡åŒ–ç›¸å…³å“åº”
      const quantResponses = {
        strategy: `ğŸ¤– **é‡åŒ–ç­–ç•¥æ¨è**

åŸºäºå½“å‰å¸‚åœºç¯å¢ƒï¼Œæˆ‘ä¸ºæ‚¨æ¨èä»¥ä¸‹é€‚åˆæ•£æˆ·çš„é‡åŒ–ç­–ç•¥ï¼š

**1. å‡å€¼å›å½’ç­–ç•¥**
â€¢ é€‚ç”¨åœºæ™¯ï¼šéœ‡è¡å¸‚åœº
â€¢ é¢„æœŸå¹´åŒ–æ”¶ç›Šï¼š12-18%
â€¢ é£é™©ç­‰çº§ï¼šä¸­ç­‰
â€¢ ç­–ç•¥åŸç†ï¼šåˆ©ç”¨ä»·æ ¼åç¦»å‡å€¼åçš„å›å½’ç‰¹æ€§

**2. åŠ¨é‡ç­–ç•¥**
â€¢ é€‚ç”¨åœºæ™¯ï¼šè¶‹åŠ¿æ˜ç¡®çš„å¸‚åœº
â€¢ é¢„æœŸå¹´åŒ–æ”¶ç›Šï¼š15-25%
â€¢ é£é™©ç­‰çº§ï¼šè¾ƒé«˜
â€¢ ç­–ç•¥åŸç†ï¼šè¿½è¸ªå¼ºåŠ¿è‚¡ç¥¨çš„æŒç»­ä¸Šæ¶¨

**3. å¤šå› å­é€‰è‚¡æ¨¡å‹**
â€¢ é€‚ç”¨åœºæ™¯ï¼šé•¿æœŸæŠ•èµ„
â€¢ é¢„æœŸå¹´åŒ–æ”¶ç›Šï¼š10-20%
â€¢ é£é™©ç­‰çº§ï¼šä¸­ç­‰
â€¢ ç­–ç•¥åŸç†ï¼šç»¼åˆä¼°å€¼ã€ç›ˆåˆ©ã€æˆé•¿ç­‰å¤šä¸ªå› å­

ğŸ’¡ **å»ºè®®**ï¼šå¯ä»¥åœ¨ä¾§è¾¹æ çš„"é‡åŒ–åˆ†æ"ä¸­è¿›è¡Œè¯¦ç»†çš„ç­–ç•¥å›æµ‹å’Œå› å­åˆ†æã€‚`,

        factor: `ğŸ“Š **å¤šå› å­é€‰è‚¡åˆ†æ**

åŸºäºé‡åŒ–å› å­æ¨¡å‹ï¼Œæˆ‘ä¸ºæ‚¨åˆ†æäº†å½“å‰å¸‚åœºçš„æœ‰æ•ˆå› å­ï¼š

**ä¼°å€¼å› å­**
â€¢ PEå› å­ï¼šå½“å‰æœ‰æ•ˆæ€§è¾ƒé«˜ï¼ŒICå€¼0.08
â€¢ PBå› å­ï¼šåœ¨é“¶è¡Œã€åœ°äº§æ¿å—è¡¨ç°çªå‡º
â€¢ å»ºè®®æƒé‡ï¼š25%

**ç›ˆåˆ©å› å­**
â€¢ ROEå› å­ï¼šæŒç»­æœ‰æ•ˆï¼Œé€‚åˆé•¿æœŸæŒæœ‰
â€¢ å‡€åˆ©æ¶¦å¢é•¿ç‡ï¼šåœ¨æˆé•¿è‚¡ä¸­è¡¨ç°ä¼˜å¼‚
â€¢ å»ºè®®æƒé‡ï¼š30%

**æŠ€æœ¯å› å­**
â€¢ åŠ¨é‡å› å­ï¼šçŸ­æœŸæœ‰æ•ˆæ€§å¼ºï¼Œé€‚åˆæ³¢æ®µæ“ä½œ
â€¢ åè½¬å› å­ï¼šåœ¨è¶…è·Œè‚¡ä¸­è¡¨ç°è‰¯å¥½
â€¢ å»ºè®®æƒé‡ï¼š20%

**è´¨é‡å› å­**
â€¢ èµ„äº§è´Ÿå€ºç‡ï¼šåœ¨å½“å‰ç¯å¢ƒä¸‹é‡è¦æ€§æå‡
â€¢ ç°é‡‘æµå› å­ï¼šé˜²å¾¡æ€§è¾ƒå¼º
â€¢ å»ºè®®æƒé‡ï¼š25%

ğŸ¯ **é€‰è‚¡å»ºè®®**ï¼šå»ºè®®ä½¿ç”¨å¤šå› å­ç»¼åˆè¯„åˆ†ï¼Œé€‰æ‹©æ’åå‰20%çš„è‚¡ç¥¨æ„å»ºæŠ•èµ„ç»„åˆã€‚`,

        signal: `ğŸ“¡ **æŠ€æœ¯æŒ‡æ ‡äº¤æ˜“ä¿¡å·**

åŸºäºå¤šç§æŠ€æœ¯æŒ‡æ ‡ç»„åˆï¼Œå½“å‰å¸‚åœºä¿¡å·å¦‚ä¸‹ï¼š

**ä¹°å…¥ä¿¡å·**
â€¢ å¹³å®‰é“¶è¡Œ(000001)ï¼šMACDé‡‘å‰ + RSIè¶…å–åå¼¹
â€¢ æ‹›å•†é“¶è¡Œ(600036)ï¼šå‡çº¿å¤šå¤´æ’åˆ— + æˆäº¤é‡æ”¾å¤§
â€¢ äº”ç²®æ¶²(000858)ï¼šå¸ƒæ—å¸¦ä¸‹è½¨åå¼¹ + KDJé‡‘å‰

**å–å‡ºä¿¡å·**
â€¢ æŸç§‘æŠ€è‚¡ï¼šRSIè¶…ä¹° + é¡¶èƒŒç¦»
â€¢ æŸåœ°äº§è‚¡ï¼šè·Œç ´é‡è¦æ”¯æ’‘ä½

**è§‚æœ›ä¿¡å·**
â€¢ å¤§ç›˜æŒ‡æ•°ï¼šåœ¨å…³é”®é˜»åŠ›ä½é™„è¿‘éœ‡è¡
â€¢ å»ºè®®ç­‰å¾…æ˜ç¡®çªç ´ä¿¡å·

âš ï¸ **é£é™©æç¤º**ï¼šæŠ€æœ¯æŒ‡æ ‡å…·æœ‰æ»åæ€§ï¼Œå»ºè®®ç»“åˆåŸºæœ¬é¢åˆ†æä½¿ç”¨ã€‚ä¿¡å·ä»…ä¾›å‚è€ƒï¼ŒæŠ•èµ„éœ€è°¨æ…ã€‚`,

        backtest: `ğŸ“ˆ **ç­–ç•¥å›æµ‹ç»“æœ**

æˆ‘ä¸ºæ‚¨æ¨¡æ‹Ÿäº†ä¸€ä¸ªå¤šå› å­ç­–ç•¥çš„å†å²å›æµ‹ï¼š

**å›æµ‹å‚æ•°**
â€¢ å›æµ‹æœŸé—´ï¼š2020-01-01 è‡³ 2024-01-01
â€¢ åˆå§‹èµ„é‡‘ï¼š100ä¸‡å…ƒ
â€¢ è‚¡ç¥¨æ± ï¼šæ²ªæ·±300
â€¢ è°ƒä»“é¢‘ç‡ï¼šæœˆåº¦

**å›æµ‹ç»“æœ**
â€¢ æ€»æ”¶ç›Šç‡ï¼š+68.5%
â€¢ å¹´åŒ–æ”¶ç›Šç‡ï¼š+14.2%
â€¢ æœ€å¤§å›æ’¤ï¼š-12.8%
â€¢ å¤æ™®æ¯”ç‡ï¼š1.35
â€¢ èƒœç‡ï¼š58.3%
â€¢ äº¤æ˜“æ¬¡æ•°ï¼š156æ¬¡

**åŸºå‡†å¯¹æ¯”**
â€¢ æ²ªæ·±300æŒ‡æ•°åŒæœŸæ”¶ç›Šï¼š+28.3%
â€¢ è¶…é¢æ”¶ç›Šï¼š+40.2%
â€¢ ä¿¡æ¯æ¯”ç‡ï¼š1.12

âœ… **ç­–ç•¥è¯„ä»·**ï¼šè¯¥ç­–ç•¥åœ¨å†å²æ•°æ®ä¸­è¡¨ç°è‰¯å¥½ï¼Œå…·æœ‰è¾ƒå¥½çš„é£é™©è°ƒæ•´æ”¶ç›Šã€‚ä½†è¯·æ³¨æ„ï¼Œå†å²è¡¨ç°ä¸ä»£è¡¨æœªæ¥æ”¶ç›Šã€‚`,
      };

      // æ ¹æ®æ¶ˆæ¯å†…å®¹é€‰æ‹©åˆé€‚çš„å“åº”
      let quantContent;

      // æ£€æŸ¥æ˜¯å¦æ˜¯å…·ä½“çš„ç­–ç•¥åˆ†æè¯·æ±‚
      if (message.includes("å‡å€¼å›å½’ç­–ç•¥")) {
        quantContent = `ğŸ¤– **å‡å€¼å›å½’ç­–ç•¥è¯¦ç»†åˆ†æ**

**ç­–ç•¥åŸç†**
å‡å€¼å›å½’ç­–ç•¥åŸºäº"ä»·æ ¼ä¼šå›å½’åˆ°å…¶é•¿æœŸå‡å€¼"çš„ç†è®ºï¼Œå½“ä»·æ ¼åç¦»å‡å€¼è¿‡å¤šæ—¶è¿›è¡Œåå‘æ“ä½œã€‚

**å…·ä½“å®æ–½æ–¹æ¡ˆ**
1. **å‚æ•°è®¾ç½®**
   â€¢ å‡å€¼è®¡ç®—å‘¨æœŸï¼š20æ—¥ç§»åŠ¨å¹³å‡çº¿
   â€¢ åç¦»é˜ˆå€¼ï¼šÂ±2ä¸ªæ ‡å‡†å·®
   â€¢ æŒä»“å‘¨æœŸï¼š5-15ä¸ªäº¤æ˜“æ—¥

2. **äº¤æ˜“è§„åˆ™**
   â€¢ ä¹°å…¥æ¡ä»¶ï¼šä»·æ ¼è·Œç ´å‡å€¼-2Ïƒæ—¶ä¹°å…¥
   â€¢ å–å‡ºæ¡ä»¶ï¼šä»·æ ¼å›å½’åˆ°å‡å€¼+1Ïƒæ—¶å–å‡º
   â€¢ æ­¢æŸæ¡ä»¶ï¼šä»·æ ¼ç»§ç»­åç¦»è¶…è¿‡-3Ïƒæ—¶æ­¢æŸ

3. **é£é™©æ§åˆ¶**
   â€¢ å•ç¬”æŠ•èµ„ä¸è¶…è¿‡æ€»èµ„é‡‘çš„10%
   â€¢ åŒæ—¶æŒä»“ä¸è¶…è¿‡5åªè‚¡ç¥¨
   â€¢ è®¾ç½®15%çš„æ­¢æŸçº¿

**é€‚ç”¨ç¯å¢ƒ**
â€¢ æœ€é€‚åˆï¼šéœ‡è¡å¸‚åœºï¼Œæ³¢åŠ¨ç‡é€‚ä¸­
â€¢ ä¸é€‚åˆï¼šå•è¾¹è¶‹åŠ¿å¸‚åœº
â€¢ æ¨èæ¿å—ï¼šå¤§ç›˜è“ç­¹è‚¡ã€é“¶è¡Œè‚¡

**é¢„æœŸè¡¨ç°**
â€¢ å¹´åŒ–æ”¶ç›Šï¼š12-18%
â€¢ æœ€å¤§å›æ’¤ï¼š-8.2%
â€¢ èƒœç‡ï¼šçº¦65%
â€¢ å¤æ™®æ¯”ç‡ï¼š1.34

**å®æ“å»ºè®®**
1. é€‰æ‹©æµåŠ¨æ€§å¥½çš„å¤§ç›˜è‚¡
2. é¿å…åœ¨é‡å¤§äº‹ä»¶å‰åä½¿ç”¨
3. å®šæœŸæ£€æŸ¥å‚æ•°æœ‰æ•ˆæ€§
4. ç»“åˆåŸºæœ¬é¢ç­›é€‰æ ‡çš„`;
      } else if (message.includes("åŠ¨é‡ç­–ç•¥")) {
        quantContent = `ğŸš€ **åŠ¨é‡ç­–ç•¥è¯¦ç»†åˆ†æ**

**ç­–ç•¥åŸç†**
åŠ¨é‡ç­–ç•¥åŸºäº"å¼ºè€…æ’å¼º"çš„å¸‚åœºè§„å¾‹ï¼Œè¿½è¸ªä»·æ ¼è¶‹åŠ¿çš„æŒç»­æ€§ï¼Œåœ¨ä¸Šæ¶¨è¶‹åŠ¿ä¸­ä¹°å…¥å¼ºåŠ¿è‚¡ç¥¨ã€‚

**å…·ä½“å®æ–½æ–¹æ¡ˆ**
1. **å‚æ•°è®¾ç½®**
   â€¢ åŠ¨é‡å‘¨æœŸï¼šè¿‡å»20ä¸ªäº¤æ˜“æ—¥
   â€¢ å¼ºåŠ¿é˜ˆå€¼ï¼šæ¶¨å¹…æ’åå‰20%
   â€¢ æŒä»“å‘¨æœŸï¼š1-3ä¸ªæœˆ

2. **äº¤æ˜“è§„åˆ™**
   â€¢ ä¹°å…¥æ¡ä»¶ï¼šè‚¡ç¥¨20æ—¥æ¶¨å¹…>15%ä¸”æˆäº¤é‡æ”¾å¤§
   â€¢ åŠ ä»“æ¡ä»¶ï¼šçªç ´å‰æœŸé«˜ç‚¹ä¸”é‡ä»·é½å‡
   â€¢ å–å‡ºæ¡ä»¶ï¼šè·Œç ´20æ—¥å‡çº¿æˆ–æ¶¨å¹…æ’åè·Œå‡ºå‰50%

3. **é£é™©æ§åˆ¶**
   â€¢ ä¸¥æ ¼æ­¢æŸï¼šè·Œç ´ä¹°å…¥ä»·8%ç«‹å³æ­¢æŸ
   â€¢ åˆ†æ‰¹å»ºä»“ï¼šåˆ†3æ¬¡å»ºä»“ï¼Œæ¯æ¬¡1/3ä»“ä½
   â€¢ è¡Œä¸šåˆ†æ•£ï¼šä¸è¶…è¿‡3ä¸ªè¡Œä¸š

**é€‚ç”¨ç¯å¢ƒ**
â€¢ æœ€é€‚åˆï¼šç‰›å¸‚æˆ–æ˜ç¡®ä¸Šå‡è¶‹åŠ¿
â€¢ ä¸é€‚åˆï¼šéœ‡è¡å¸‚æˆ–ç†Šå¸‚
â€¢ æ¨èæ¿å—ï¼šç§‘æŠ€è‚¡ã€æ–°èƒ½æºã€åŒ»è¯

**é¢„æœŸè¡¨ç°**
â€¢ å¹´åŒ–æ”¶ç›Šï¼š15-25%
â€¢ æœ€å¤§å›æ’¤ï¼š-15.7%
â€¢ èƒœç‡ï¼šçº¦55%
â€¢ å¤æ™®æ¯”ç‡ï¼š1.12

**å®æ“å»ºè®®**
1. å…³æ³¨å¸‚åœºçƒ­ç‚¹å’Œé¢˜æè‚¡
2. ä¸¥æ ¼æ‰§è¡Œæ­¢æŸçºªå¾‹
3. åœ¨è¶‹åŠ¿ç¡®ç«‹åå†è¿›å…¥
4. æ³¨æ„ä»“ä½ç®¡ç†ï¼Œé¿å…è¿½é«˜`;
      } else if (message.includes("é…å¯¹äº¤æ˜“")) {
        quantContent = `âš–ï¸ **é…å¯¹äº¤æ˜“ç­–ç•¥è¯¦ç»†åˆ†æ**

**ç­–ç•¥åŸç†**
é…å¯¹äº¤æ˜“é€šè¿‡åšå¤šè¢«ä½ä¼°çš„è‚¡ç¥¨ï¼ŒåŒæ—¶åšç©ºè¢«é«˜ä¼°çš„è‚¡ç¥¨ï¼Œåˆ©ç”¨ä¸¤åªç›¸å…³è‚¡ç¥¨é—´çš„ä»·å·®å›å½’è·åˆ©ã€‚

**å…·ä½“å®æ–½æ–¹æ¡ˆ**
1. **è‚¡ç¥¨é…å¯¹é€‰æ‹©**
   â€¢ åŒè¡Œä¸šé¾™å¤´è‚¡ï¼šå¦‚æ‹›å•†é“¶è¡Œ vs å¹³å®‰é“¶è¡Œ
   â€¢ ç›¸å…³ç³»æ•°>0.7çš„è‚¡ç¥¨å¯¹
   â€¢ åŸºæœ¬é¢ç›¸ä¼¼ä½†ä¼°å€¼æœ‰å·®å¼‚

2. **äº¤æ˜“è§„åˆ™**
   â€¢ ä»·å·®åç¦»å†å²å‡å€¼2Ïƒæ—¶å»ºä»“
   â€¢ åšå¤šç›¸å¯¹ä¾¿å®œçš„è‚¡ç¥¨
   â€¢ åšç©ºç›¸å¯¹æ˜‚è´µçš„è‚¡ç¥¨ï¼ˆAè‚¡å¯ç”¨èåˆ¸ï¼‰
   â€¢ ä»·å·®å›å½’åˆ°å‡å€¼æ—¶å¹³ä»“

3. **é£é™©æ§åˆ¶**
   â€¢ å¸‚åœºä¸­æ€§ï¼šå¤šç©ºä»“ä½åŸºæœ¬å¹³è¡¡
   â€¢ æ­¢æŸçº¿ï¼šä»·å·®ç»§ç»­æ‰©å¤§è¶…è¿‡3Ïƒ
   â€¢ æ—¶é—´æ­¢æŸï¼šæŒä»“è¶…è¿‡3ä¸ªæœˆå¼ºåˆ¶å¹³ä»“

**é€‚ç”¨ç¯å¢ƒ**
â€¢ æœ€é€‚åˆï¼šä»»ä½•å¸‚åœºç¯å¢ƒï¼ˆå¸‚åœºä¸­æ€§ï¼‰
â€¢ ç‰¹åˆ«é€‚åˆï¼šéœ‡è¡å¸‚åœº
â€¢ æ¨èé…å¯¹ï¼šé“¶è¡Œè‚¡ã€åœ°äº§è‚¡ã€é’¢é“è‚¡

**é¢„æœŸè¡¨ç°**
â€¢ å¹´åŒ–æ”¶ç›Šï¼š8-12%
â€¢ æœ€å¤§å›æ’¤ï¼š-4.1%
â€¢ èƒœç‡ï¼šçº¦70%
â€¢ å¤æ™®æ¯”ç‡ï¼š1.67

**å®æ“å»ºè®®**
1. é€‰æ‹©æµåŠ¨æ€§å¥½çš„è‚¡ç¥¨å¯¹
2. å®šæœŸæ£€æŸ¥ç›¸å…³æ€§æ˜¯å¦ç¨³å®š
3. æ³¨æ„èåˆ¸æˆæœ¬å’Œå¯èåˆ¸æ•°é‡
4. é¿å…åœ¨é‡å¤§äº‹ä»¶æœŸé—´æ“ä½œ`;
      } else if (message.includes("å¤šå› å­æ¨¡å‹")) {
        quantContent = `ğŸ§® **å¤šå› å­é€‰è‚¡æ¨¡å‹è¯¦ç»†åˆ†æ**

**ç­–ç•¥åŸç†**
å¤šå› å­æ¨¡å‹é€šè¿‡ç»¼åˆå¤šä¸ªæœ‰æ•ˆå› å­å¯¹è‚¡ç¥¨è¿›è¡Œè¯„åˆ†æ’åºï¼Œé€‰æ‹©ç»¼åˆè¯„åˆ†æœ€é«˜çš„è‚¡ç¥¨æ„å»ºæŠ•èµ„ç»„åˆã€‚

**å…·ä½“å®æ–½æ–¹æ¡ˆ**
1. **å› å­ä½“ç³»**
   â€¢ ä¼°å€¼å› å­ï¼ˆ25%æƒé‡ï¼‰ï¼šPEã€PBã€PS
   â€¢ ç›ˆåˆ©å› å­ï¼ˆ30%æƒé‡ï¼‰ï¼šROEã€ROAã€å‡€åˆ©æ¶¦å¢é•¿ç‡
   â€¢ æˆé•¿å› å­ï¼ˆ25%æƒé‡ï¼‰ï¼šè¥æ”¶å¢é•¿ç‡ã€EPSå¢é•¿ç‡
   â€¢ è´¨é‡å› å­ï¼ˆ20%æƒé‡ï¼‰ï¼šèµ„äº§è´Ÿå€ºç‡ã€ç°é‡‘æµ

2. **é€‰è‚¡æµç¨‹**
   â€¢ å› å­æ ‡å‡†åŒ–å¤„ç†
   â€¢ åŠ æƒè®¡ç®—ç»¼åˆå¾—åˆ†
   â€¢ é€‰æ‹©å¾—åˆ†å‰20%çš„è‚¡ç¥¨
   â€¢ ç­‰æƒé‡æ„å»ºæŠ•èµ„ç»„åˆ

3. **è°ƒä»“è§„åˆ™**
   â€¢ è°ƒä»“é¢‘ç‡ï¼šæ¯æœˆè°ƒä»“ä¸€æ¬¡
   â€¢ æ¢æ‰‹ç‡æ§åˆ¶ï¼šå•æ¬¡è°ƒä»“ä¸è¶…è¿‡30%
   â€¢ è¡Œä¸šä¸­æ€§ï¼šå„è¡Œä¸šæƒé‡ä¸åç¦»åŸºå‡†è¿‡å¤š

**é€‚ç”¨ç¯å¢ƒ**
â€¢ æœ€é€‚åˆï¼šä¸­é•¿æœŸæŠ•èµ„
â€¢ é€‚ç”¨å¸‚åœºï¼šå„ç§å¸‚åœºç¯å¢ƒ
â€¢ æ¨èèŒƒå›´ï¼šå…¨å¸‚åœºé€‰è‚¡

**é¢„æœŸè¡¨ç°**
â€¢ å¹´åŒ–æ”¶ç›Šï¼š15-20%
â€¢ æœ€å¤§å›æ’¤ï¼š-9.8%
â€¢ èƒœç‡ï¼šçº¦62%
â€¢ å¤æ™®æ¯”ç‡ï¼š1.45

**å®æ“å»ºè®®**
1. å®šæœŸæ£€æŸ¥å› å­æœ‰æ•ˆæ€§
2. æ ¹æ®å¸‚åœºç¯å¢ƒè°ƒæ•´å› å­æƒé‡
3. æ³¨æ„å› å­é—´çš„ç›¸å…³æ€§
4. ç»“åˆå®è§‚ç¯å¢ƒä¼˜åŒ–æ¨¡å‹`;
      } else if (message.includes("å› å­")) {
        quantContent = quantResponses.factor;
      } else if (
        message.includes("ä¿¡å·") ||
        message.includes("æŠ€æœ¯æŒ‡æ ‡") ||
        message.includes("MACD") ||
        message.includes("RSI")
      ) {
        quantContent = quantResponses.signal;
      } else if (message.includes("å›æµ‹")) {
        quantContent = quantResponses.backtest;
      } else {
        quantContent = quantResponses.strategy; // é»˜è®¤è¿”å›ç­–ç•¥ä»‹ç»
      }

      response = {
        role: "assistant",
        content: quantContent,
        hasStockInfo: false,
        isQuantAnalysis: true, // æ ‡è¯†è¿™æ˜¯é‡åŒ–åˆ†æ
      };
    } else if (isStockQuery) {
      // æ¨¡æ‹Ÿè‚¡ç¥¨åˆ†æå“åº”ï¼ŒåŒ…å«ç»“æ„åŒ–è‚¡ç¥¨ä¿¡æ¯
      const stockInfo = {
        code: "000001",
        name: "å¹³å®‰é“¶è¡Œ",
        price: "12.45",
        change: 0.23,
        changePercent: 1.88,
        industry: "é“¶è¡Œ",
        pe: 5.2,
        pb: 0.8,
        marketCap: 240000000000,
        analysis: {
          fundamental: "å…¬å¸åŸºæœ¬é¢è‰¯å¥½ï¼ŒROEæŒç»­æå‡ï¼Œèµ„äº§è´¨é‡ç¨³å®šã€‚",
          technical: "æŠ€æœ¯é¢æ˜¾ç¤ºè‚¡ä»·å¤„äºä¸Šå‡é€šé“ï¼ŒMACDé‡‘å‰ï¼ŒRSIæŒ‡æ ‡å¥åº·ã€‚",
          recommendation: "å»ºè®®é€‚é‡é…ç½®ï¼Œç›®æ ‡ä»·ä½13.5å…ƒã€‚",
          risk: "éœ€å…³æ³¨é“¶è¡Œä¸šç›‘ç®¡æ”¿ç­–å˜åŒ–å’Œåˆ©ç‡ç¯å¢ƒå½±å“ã€‚",
        },
      };

      response = {
        role: "assistant",
        content: `æ ¹æ®æ‚¨çš„æŸ¥è¯¢ï¼Œæˆ‘ä¸ºæ‚¨åˆ†æäº†${stockInfo.name}(${stockInfo.code})ï¼š

**åŸºæœ¬ä¿¡æ¯**
â€¢ å½“å‰ä»·æ ¼ï¼šÂ¥${stockInfo.price}
â€¢ æ¶¨è·Œå¹…ï¼š${stockInfo.change > 0 ? "+" : ""}${stockInfo.change}(${stockInfo.changePercent > 0 ? "+" : ""}${stockInfo.changePercent}%)
â€¢ æ‰€å±è¡Œä¸šï¼š${stockInfo.industry}
â€¢ å¸‚ç›ˆç‡ï¼š${stockInfo.pe}
â€¢ å¸‚å‡€ç‡ï¼š${stockInfo.pb}

**æŠ•èµ„åˆ†æ**
ğŸ“Š **åŸºæœ¬é¢åˆ†æ**ï¼š${stockInfo.analysis.fundamental}

ğŸ“ˆ **æŠ€æœ¯é¢åˆ†æ**ï¼š${stockInfo.analysis.technical}

ğŸ’¡ **æŠ•èµ„å»ºè®®**ï¼š${stockInfo.analysis.recommendation}

âš ï¸ **é£é™©æç¤º**ï¼š${stockInfo.analysis.risk}`,
        stockInfo: stockInfo, // é™„åŠ è‚¡ç¥¨ä¿¡æ¯ç”¨äºè‡ªé€‰è‚¡åŠŸèƒ½
        hasStockInfo: true,
      };
    } else {
      // æ™®é€šAIå“åº”
      const responses = [
        "æ ¹æ®æ‚¨çš„é£é™©åå¥½å’ŒæŠ•èµ„ç›®æ ‡ï¼Œæˆ‘å»ºè®®æ‚¨å¯ä»¥å…³æ³¨ä»¥ä¸‹è‚¡ç¥¨ã€‚",
        "ä»æŠ€æœ¯é¢åˆ†æï¼Œè¯¥è‚¡ç¥¨ç›®å‰å¤„äºä¸Šå‡è¶‹åŠ¿ï¼Œä½†éœ€è¦æ³¨æ„é£é™©æ§åˆ¶ã€‚",
        "æ ¹æ®åŸºæœ¬é¢åˆ†æï¼Œè¯¥å…¬å¸çš„è´¢åŠ¡çŠ¶å†µè‰¯å¥½ï¼Œå…·æœ‰é•¿æœŸæŠ•èµ„ä»·å€¼ã€‚",
        "å»ºè®®æ‚¨å…³æ³¨è¯¥è¡Œä¸šçš„é¾™å¤´ä¼ä¸šï¼Œå®ƒä»¬é€šå¸¸å…·æœ‰æ›´å¥½çš„æŠ—é£é™©èƒ½åŠ›ã€‚",
        "ä»ä¼°å€¼è§’åº¦æ¥çœ‹ï¼Œç›®å‰è¯¥è‚¡ç¥¨çš„PEå¤„äºå†å²ä½ä½ï¼Œå…·æœ‰æŠ•èµ„ä»·å€¼ã€‚",
      ];

      response = {
        role: "assistant",
        content: responses[Math.floor(Math.random() * responses.length)],
        hasStockInfo: false,
      };
    }

    chatHistory.push({ role: "user", content: message }, response);

    return Promise.resolve({
      code: 200,
      data: response,
      message: "success",
    });
  },
};
