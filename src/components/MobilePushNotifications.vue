<template>
    <div class="mobile-push-container">
        <!-- Â§¥ÈÉ® -->
        <div class="push-header">
            <h3>Ê∂àÊÅØÊé®ÈÄÅ</h3>
            <div class="header-actions">
                <button @click="markAllAsRead" class="action-btn">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none">
                        <path d="M20 6L9 17l-5-5" stroke="currentColor" stroke-width="2" />
                    </svg>
                    ÂÖ®ÈÉ®Â∑≤ËØª
                </button>
                <button @click="openSettings" class="action-btn settings-btn">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none">
                        <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2" />
                        <path d="M12 1v6m0 6v6m11-7h-6m-6 0H1" stroke="currentColor" stroke-width="2" />
                    </svg>
                </button>
            </div>
        </div>

        <!-- ÂàÜÁ±ªÊ†áÁ≠æ -->
        <div class="notification-categories">
            <div class="category-scroll">
                <button v-for="category in categories" :key="category.id" @click="activeCategory = category.id"
                    :class="['category-btn', { active: activeCategory === category.id }]">
                    <span class="category-icon">{{ category.icon }}</span>
                    <span class="category-name">{{ category.name }}</span>
                    <span v-if="category.count > 0" class="category-count">{{ category.count }}</span>
                </button>
            </div>
        </div>

        <!-- ÈÄöÁü•ÂàóË°® -->
        <div class="notifications-container" ref="container" data-scrollable>
            <!-- ‰∏ãÊãâÂà∑Êñ∞ÊåáÁ§∫Âô® -->
            <div v-if="isRefreshing" class="refresh-indicator">
                <div class="refresh-spinner"></div>
                <span>Ê≠£Âú®Âà∑Êñ∞...</span>
            </div>

            <!-- ÈÄöÁü•ÂàóË°® -->
            <div class="notifications-list">
                <div v-for="notification in filteredNotifications" :key="notification.id" class="notification-card"
                    :class="{
                        'unread': !notification.read,
                        'new-message': notification.isNew,
                        'urgent': notification.priority === 'urgent'
                    }" @click="openNotification(notification)">

                    <div class="notification-content">
                        <div class="notification-header">
                            <div class="app-info">
                                <div class="app-icon" :class="notification.type">
                                    {{ getTypeIcon(notification.type) }}
                                </div>
                                <div class="meta">
                                    <span class="app-name">ÊäïËµÑÂä©Êâã</span>
                                    <span class="time">{{ formatTime(notification.time) }}</span>
                                </div>
                            </div>
                            <div v-if="!notification.read" class="unread-dot"></div>
                        </div>

                        <div class="notification-body">
                            <h4 class="title">{{ notification.title }}</h4>
                            <p class="message">{{ notification.message }}</p>
                        </div>

                        <div class="actions">
                            <button v-for="action in notification.actions" :key="action.id"
                                @click.stop="handleAction(notification, action)"
                                :class="['action-button', action.type]">
                                {{ action.text }}
                            </button>
                            <button @click.stop="markAsRead(notification)" v-if="!notification.read"
                                class="action-button secondary">
                                Ê†áËÆ∞Â∑≤ËØª
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Á©∫Áä∂ÊÄÅ -->
                <div v-if="filteredNotifications.length === 0" class="empty-state">
                    <div class="empty-icon">üì≠</div>
                    <p class="empty-text">ÊöÇÊó†Ê∂àÊÅØ</p>
                    <p class="empty-desc">ÂºÄÂêØÊé®ÈÄÅÈÄöÁü•ÔºåÂèäÊó∂Ëé∑ÂèñÈáçË¶Å‰ø°ÊÅØ</p>
                </div>

                <!-- Âä†ËΩΩÊõ¥Â§ö -->
                <div v-if="hasMore && filteredNotifications.length > 0" class="load-more">
                    <button @click="loadMore" :disabled="isLoading" class="load-more-btn">
                        <div v-if="isLoading" class="loading-spinner"></div>
                        <span>{{ isLoading ? 'Âä†ËΩΩ‰∏≠...' : 'Âä†ËΩΩÊõ¥Â§ö' }}</span>
                    </button>
                </div>

                <!-- Â∑≤Âä†ËΩΩÂÆåÊØïÊèêÁ§∫ -->
                <div v-if="!hasMore && filteredNotifications.length > 0" class="load-complete">
                    <span class="complete-icon">‚úì</span>
                    <span class="complete-text">Â∑≤ÊòæÁ§∫ÂÖ®ÈÉ®Ê∂àÊÅØ</span>
                </div>
            </div>
        </div>

        <!-- ÊùÉÈôêÊèêÁ§∫ -->
        <div v-if="showPermissionTip" class="permission-tip">
            <div class="tip-content">
                <span class="tip-icon">üîî</span>
                <span class="tip-text">ÂºÄÂêØÊé®ÈÄÅÈÄöÁü•Ëé∑ÂèñÂÆûÊó∂Ê∂àÊÅØ</span>
                <button @click="requestPermission" class="tip-btn">ÂºÄÂêØ</button>
                <button @click="showPermissionTip = false" class="tip-close">‚úï</button>
            </div>
        </div>

        <!-- Toast ÊèêÁ§∫ -->
        <div v-if="toast.show" class="toast" :class="toast.type">
            {{ toast.message }}
        </div>

        <!-- Ê∂àÊÅØËØ¶ÊÉÖÂºπÁ™ó -->
        <Teleport to="body">
            <div v-if="showDetailDialog" class="detail-overlay" @click="closeDetail">
                <div class="detail-dialog" @click.stop>
                    <!-- ÁßªÂä®Á´ØÊãñÊãΩÊåáÁ§∫Âô® -->
                    <div class="drag-indicator" @touchstart="handleDetailTouchStart" @touchmove="handleDetailTouchMove"
                        @touchend="handleDetailTouchEnd"></div>

                    <!-- ÂºπÁ™óÂ§¥ÈÉ® -->
                    <div class="detail-header">
                        <div class="detail-app-info">
                            <div class="detail-app-icon" :class="selectedNotification?.type">
                                {{ getTypeIcon(selectedNotification?.type) }}
                            </div>
                            <div class="detail-meta">
                                <span class="detail-app-name">ÊäïËµÑÂä©Êâã</span>
                                <span class="detail-time">{{ formatTime(selectedNotification?.time) }}</span>
                            </div>
                        </div>
                        <button @click="closeDetail" class="detail-close">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" />
                            </svg>
                        </button>
                    </div>

                    <!-- ËØ¶ÊÉÖÂÜÖÂÆπ -->
                    <div class="detail-content" data-scrollable>
                        <div class="detail-priority" v-if="selectedNotification?.priority === 'urgent'">
                            <span class="priority-badge urgent">üî¥ Á¥ßÊÄ•</span>
                        </div>

                        <h3 class="detail-title">{{ selectedNotification?.title }}</h3>
                        <div class="detail-message">{{ selectedNotification?.message }}</div>

                        <!-- ËØ¶ÁªÜ‰ø°ÊÅØ -->
                        <div v-if="selectedNotification?.details" class="detail-extra">
                            <h4 class="extra-title">ËØ¶ÁªÜ‰ø°ÊÅØ</h4>
                            <div class="extra-content">{{ selectedNotification.details }}</div>
                        </div>

                        <!-- Áõ∏ÂÖ≥Êï∞ÊçÆ -->
                        <div v-if="selectedNotification?.data" class="detail-data">
                            <h4 class="data-title">Áõ∏ÂÖ≥Êï∞ÊçÆ</h4>
                            <div class="data-list">
                                <div v-for="(value, key) in selectedNotification.data" :key="key" class="data-item">
                                    <span class="data-label">{{ key }}:</span>
                                    <span class="data-value">{{ value }}</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ÂºπÁ™óÂ∫ïÈÉ®Êìç‰Ωú -->
                    <div class="detail-footer">
                        <button v-for="action in selectedNotification?.actions" :key="action.id"
                            @click="handleDetailAction(selectedNotification, action)"
                            :class="['detail-action-button', action.type]">
                            {{ action.text }}
                        </button>
                        <button v-if="!selectedNotification?.read" @click="markAsReadAndClose"
                            class="detail-action-button secondary">
                            Ê†áËÆ∞Â∑≤ËØª
                        </button>
                    </div>
                </div>
            </div>
        </Teleport>

        <!-- Êé®ÈÄÅËÆæÁΩÆÂºπÁ™ó -->
        <Teleport to="body">
            <div v-if="showSettingsDialog" class="settings-overlay" @click="closeSettings">
                <div class="settings-dialog" @click.stop>
                    <!-- ÁßªÂä®Á´ØÊãñÊãΩÊåáÁ§∫Âô® -->
                    <div class="drag-indicator" @touchstart="handleTouchStart" @touchmove="handleTouchMove"
                        @touchend="handleTouchEnd"></div>

                    <!-- ÂºπÁ™óÂ§¥ÈÉ® -->
                    <div class="settings-header">
                        <h3 class="settings-title">Êé®ÈÄÅËÆæÁΩÆ</h3>
                        <button @click="closeSettings" class="settings-close">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" />
                            </svg>
                        </button>
                    </div>

                    <!-- ËÆæÁΩÆÂÜÖÂÆπ -->
                    <div class="settings-content" @scroll="handleContentScroll" data-scrollable>
                        <!-- Ê∂àÊÅØÁ±ªÂûãÊé®ÈÄÅ -->
                        <div class="setting-section">
                            <h4 class="section-title">Ê∂àÊÅØÁ±ªÂûãÊé®ÈÄÅ</h4>
                            <div class="setting-item" v-for="category in settingCategories" :key="category.id">
                                <div class="setting-info">
                                    <div class="setting-label">{{ category.name }}</div>
                                    <div class="setting-desc">{{ category.description }}</div>
                                </div>
                                <div class="setting-control">
                                    <label class="toggle-switch">
                                        <input type="checkbox" v-model="settings[category.id]">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div class="settings-divider"></div>

                        <!-- Êé®ÈÄÅÊó∂Èó¥ -->
                        <div class="setting-section">
                            <h4 class="section-title">Êé®ÈÄÅÊó∂Èó¥</h4>
                            <div class="time-range">
                                <div class="time-input">
                                    <label>ÂºÄÂßãÊó∂Èó¥</label>
                                    <input type="time" v-model="settings.startTime" class="time-picker">
                                </div>
                                <div class="time-input">
                                    <label>ÁªìÊùüÊó∂Èó¥</label>
                                    <input type="time" v-model="settings.endTime" class="time-picker">
                                </div>
                            </div>

                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-label">ÂÖçÊâìÊâ∞Ê®°Âºè</div>
                                    <div class="setting-desc">ÊåáÂÆöÊó∂Èó¥ÊÆµÂÜÖ‰∏çÊé•Êî∂Êé®ÈÄÅ</div>
                                </div>
                                <div class="setting-control">
                                    <label class="toggle-switch">
                                        <input type="checkbox" v-model="settings.doNotDisturb">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div class="settings-divider"></div>

                        <!-- Êé®ÈÄÅÈ¢ëÁéá -->
                        <div class="setting-section">
                            <h4 class="section-title">Êé®ÈÄÅÈ¢ëÁéá</h4>
                            <div class="frequency-options">
                                <label class="frequency-option">
                                    <input v-model="settings.frequency" type="radio" value="realtime"
                                        class="frequency-radio">
                                    <div class="frequency-content">
                                        <span class="frequency-label">ÂÆûÊó∂Êé®ÈÄÅ</span>
                                        <span class="frequency-desc">Ê∂àÊÅØ‰∫ßÁîüÊó∂Á´ãÂç≥Êé®ÈÄÅ</span>
                                    </div>
                                </label>

                                <label class="frequency-option">
                                    <input v-model="settings.frequency" type="radio" value="hourly"
                                        class="frequency-radio">
                                    <div class="frequency-content">
                                        <span class="frequency-label">ÊØèÂ∞èÊó∂Ê±áÊÄª</span>
                                        <span class="frequency-desc">ÊØèÂ∞èÊó∂Ê±áÊÄªÊé®ÈÄÅ‰∏ÄÊ¨°</span>
                                    </div>
                                </label>

                                <label class="frequency-option">
                                    <input v-model="settings.frequency" type="radio" value="daily"
                                        class="frequency-radio">
                                    <div class="frequency-content">
                                        <span class="frequency-label">ÊØèÊó•Ê±áÊÄª</span>
                                        <span class="frequency-desc">ÊØèÂ§©Ê±áÊÄªÊé®ÈÄÅ‰∏ÄÊ¨°</span>
                                    </div>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- ÊªöÂä®ÊåáÁ§∫Âô® -->
                    <div v-if="showScrollIndicator" class="scroll-indicator" @click="scrollToMore">
                        <div class="scroll-hint">
                            <svg width="12" height="12" viewBox="0 0 24 24" fill="none">
                                <path d="M7 13l3 3 3-3" stroke="currentColor" stroke-width="2" />
                            </svg>
                            <span>Âêë‰∏ãÊªöÂä®Êü•ÁúãÊõ¥Â§ö</span>
                        </div>
                    </div>

                    <!-- ÂºπÁ™óÂ∫ïÈÉ® -->
                    <div class="settings-footer">
                        <button @click="resetSettings" class="reset-btn">ÈáçÁΩÆÈªòËÆ§</button>
                        <button @click="saveSettings" class="save-btn">‰øùÂ≠òËÆæÁΩÆ</button>
                    </div>
                </div>
            </div>
        </Teleport>
    </div>
</template>

<script>
export default {
    name: 'MobilePushNotifications',
    data() {
        return {
            activeCategory: 'all',
            isRefreshing: false,
            isLoading: false,
            hasMore: true,
            showPermissionTip: false,
            toast: {
                show: false,
                message: '',
                type: 'info'
            },

            // ËÆæÁΩÆÂºπÁ™óÁä∂ÊÄÅ
            showSettingsDialog: false,
            touchStartY: null,
            touchStartTime: null,
            showScrollIndicator: false,

            // ËØ¶ÊÉÖÂºπÁ™óÁä∂ÊÄÅ
            showDetailDialog: false,
            selectedNotification: null,
            detailTouchStartY: null,
            detailTouchStartTime: null,

            // Êé®ÈÄÅËÆæÁΩÆÊï∞ÊçÆ
            settings: {
                market: true,
                news: true,
                alert: true,
                system: true,
                trade: true,
                startTime: '09:00',
                endTime: '21:00',
                doNotDisturb: false,
                frequency: 'realtime'
            },

            // ËÆæÁΩÆÂàÜÁ±ªÈÖçÁΩÆ
            settingCategories: [
                {
                    id: 'trade',
                    name: '‰∫§ÊòìËÆ∞ÂΩï',
                    description: '‰π∞ÂçñËÆ∞ÂΩï„ÄÅÂßîÊâòÁä∂ÊÄÅÁ≠â'
                },
                {
                    id: 'alert',
                    name: 'È£éÈô©ÊèêÈÜí',
                    description: '‰ª∑Ê†ºÈ¢ÑË≠¶„ÄÅÈ£éÈô©ËØÑ‰º∞Á≠â'
                },
                {
                    id: 'market',
                    name: 'ÂÆûÊó∂Ë°åÊÉÖ',
                    description: 'ËÇ°‰ª∑ÂèòÂä®„ÄÅÊùøÂùóÂºÇÂä®„ÄÅÊäÄÊúØ‰ø°Âè∑Á≠â'
                },
                {
                    id: 'news',
                    name: 'Ë¥¢ÁªèËµÑËÆØ',
                    description: 'ÊîøÁ≠ñÊñ∞Èóª„ÄÅÂÖ¨Âè∏ÂÖ¨Âëä„ÄÅÂÆèËßÇÊï∞ÊçÆÁ≠â'
                },
                {
                    id: 'system',
                    name: 'Á≥ªÁªüÈÄöÁü•',
                    description: 'Á≥ªÁªüÊõ¥Êñ∞„ÄÅÂäüËÉΩÈÄöÁü•Á≠â'
                }
            ],

            categories: [
                { id: 'all', name: 'ÂÖ®ÈÉ®', icon: 'üì¨', count: 0 },
                { id: 'trade', name: '‰∫§Êòì', icon: 'üí∞', count: 0 },
                { id: 'alert', name: 'ÊèêÈÜí', icon: '‚ö†Ô∏è', count: 0 },
                { id: 'market', name: 'Ë°åÊÉÖ', icon: 'üìà', count: 0 },
                { id: 'news', name: 'ËµÑËÆØ', icon: 'üì∞', count: 0 },
                { id: 'system', name: 'Á≥ªÁªü', icon: '‚öôÔ∏è', count: 0 }
            ],
            notifications: []
        };
    },
    computed: {
        filteredNotifications() {
            if (this.activeCategory === 'all') {
                return this.notifications;
            }
            return this.notifications.filter(n => n.type === this.activeCategory);
        },
        unreadCount() {
            return this.notifications.filter(n => !n.read).length;
        }
    },
    mounted() {
        this.generateNotifications();
        this.updateCategoryCounts();
        this.checkPermission();
        this.loadSettings();
    },
    methods: {
        // ÁîüÊàêÊ®°ÊãüÈÄöÁü•
        generateNotifications() {
            this.notifications = [
                {
                    id: 1,
                    type: 'market',
                    title: 'ËÇ°‰ª∑ÊèêÈÜí',
                    message: 'ÊÇ®ÂÖ≥Ê≥®ÁöÑË¥µÂ∑ûËåÖÂè∞(600519)‰∏äÊ∂®5.2%ÔºåÂΩìÂâç‰ª∑Ê†º¬•1,850.00',
                    time: new Date(Date.now() - 5 * 60 * 1000),
                    read: false,
                    priority: 'urgent',
                    details: 'Ë¥µÂ∑ûËåÖÂè∞‰ªäÊó•ÂºÄÁõò‰ª∑¬•1,758.00ÔºåÊúÄÈ´ò‰ª∑¬•1,865.50ÔºåÊúÄ‰Ωé‰ª∑¬•1,745.20„ÄÇÊàê‰∫§ÈáèËæÉÊò®Êó•Â¢ûÈïø15.3%Ôºå‰∏ªË¶ÅÂèóÁõä‰∫éÁôΩÈÖíÊùøÂùóÊï¥‰Ωì‰∏äÊ∂®ÂíåÊú∫ÊûÑËµÑÈáëÊµÅÂÖ•„ÄÇÊäÄÊúØÊåáÊ†áÊòæÁ§∫Áü≠Êúü‰ªçÊúâ‰∏äÊ∂®Á©∫Èó¥„ÄÇ',
                    data: {
                        'ËÇ°Á•®‰ª£Á†Å': '600519',
                        'ÂΩìÂâç‰ª∑Ê†º': '¬•1,850.00',
                        'Ê∂®Ë∑åÂπÖ': '+5.2%',
                        'Ê∂®Ë∑åÈ¢ù': '+¬•91.50',
                        'Êàê‰∫§Èáè': '12.5‰∏áÊâã',
                        'Êàê‰∫§È¢ù': '23.1‰∫øÂÖÉ',
                        'Êç¢ÊâãÁéá': '0.79%',
                        'Â∏ÇÁõàÁéá': '31.2ÂÄç'
                    },
                    actions: [
                        { id: 'view', text: 'Êü•ÁúãËØ¶ÊÉÖ', type: 'primary' },
                        { id: 'trade', text: 'Á´ãÂç≥‰∫§Êòì', type: 'secondary' }
                    ]
                },
                {
                    id: 2,
                    type: 'news',
                    title: 'Ë¥¢ÁªèÂø´ËÆØ',
                    message: 'Â§ÆË°åÂÆ£Â∏ÉÈôçÂáÜ0.25‰∏™ÁôæÂàÜÁÇπÔºåÈ¢ÑËÆ°ÈáäÊîæÊµÅÂä®ÊÄßÁ∫¶5000‰∫øÂÖÉ',
                    time: new Date(Date.now() - 15 * 60 * 1000),
                    read: false,
                    priority: 'high',
                    details: '‰∏≠ÂõΩ‰∫∫Ê∞ëÈì∂Ë°åÂÜ≥ÂÆö‰∫é2024Âπ¥1Êúà15Êó•‰∏ãË∞ÉÈáëËûçÊú∫ÊûÑÂ≠òÊ¨æÂáÜÂ§áÈáëÁéá0.25‰∏™ÁôæÂàÜÁÇπÔºà‰∏çÂê´Â∑≤ÊâßË°å5%Â≠òÊ¨æÂáÜÂ§áÈáëÁéáÁöÑÈáëËûçÊú∫ÊûÑÔºâ„ÄÇÊú¨Ê¨°ÈôçÂáÜ‰∏∫ÂÖ®Èù¢ÈôçÂáÜÔºå‰ΩìÁé∞‰∫ÜÁ®≥ÂÅ•Ë¥ßÂ∏ÅÊîøÁ≠ñÁöÑÁÅµÊ¥ªÈÄÇÂ∫¶ÔºåÊúâÂà©‰∫é‰øùÊåÅÈì∂Ë°å‰ΩìÁ≥ªÊµÅÂä®ÊÄßÂêàÁêÜÂÖÖË£ïÔºå‰øÉËøõË¥ßÂ∏Å‰ø°Ë¥∑ÂêàÁêÜÂ¢ûÈïøÔºåÊîØÊåÅÈ´òË¥®ÈáèÂèëÂ±ï„ÄÇ',
                    data: {
                        'ÊîøÁ≠ñÁ±ªÂûã': 'ÂÖ®Èù¢ÈôçÂáÜ',
                        'ÈôçÂáÜÂπÖÂ∫¶': '0.25‰∏™ÁôæÂàÜÁÇπ',
                        'ÈáäÊîæÊµÅÂä®ÊÄß': 'Á∫¶5000‰∫øÂÖÉ',
                        'ÂÆûÊñΩÊó∂Èó¥': '2024Âπ¥1Êúà15Êó•',
                        'ÂΩ±ÂìçÊú∫ÊûÑ': 'Â§ßÈÉ®ÂàÜÈáëËûçÊú∫ÊûÑ',
                        'ÊîøÁ≠ñÁõÆÊ†á': 'ÊîØÊåÅÂÆû‰ΩìÁªèÊµé'
                    }
                },
                {
                    id: 3,
                    type: 'alert',
                    title: 'È£éÈô©ÊèêÈÜí',
                    message: 'ÊÇ®ÁöÑÊäïËµÑÁªÑÂêà‰ªäÊó•‰∫èÊçüË∂ÖËøá5%ÔºåÂª∫ËÆÆÂèäÊó∂ÂÖ≥Ê≥®Â∏ÇÂú∫ÂèòÂåñ',
                    time: new Date(Date.now() - 30 * 60 * 1000),
                    read: true,
                    priority: 'urgent',
                    details: 'ÊÇ®ÁöÑÊäïËµÑÁªÑÂêà‰ªäÊó•Ë°®Áé∞‰∏ç‰Ω≥Ôºå‰∏ªË¶ÅÂéüÂõ†ÊòØÁßëÊäÄËÇ°Â§ßÂπÖ‰∏ãË∑å„ÄÇÂª∫ËÆÆÂÖ≥Ê≥®Â∏ÇÂú∫ÊÉÖÁª™ÂèòÂåñÔºåËÄÉËôëÈÄÇÂΩìË∞ÉÊï¥‰ªì‰ΩçÈÖçÁΩÆ„ÄÇÂ¶ÇÊûúÊÇ®ÊòØÈïøÊúüÊäïËµÑËÄÖÔºåÂèØ‰ª•ËÄÉËôëÈÄ¢‰ΩéÂä†‰ªì‰ºòË¥®Ê†áÁöÑ„ÄÇËØ∑Ê†πÊçÆËá™Ë∫´È£éÈô©ÊâøÂèóËÉΩÂäõÂÅöÂá∫ÊäïËµÑÂÜ≥Á≠ñ„ÄÇ',
                    data: {
                        'ÊÄªËµÑ‰∫ß': '¬•158,500.00',
                        '‰ªäÊó•Áõà‰∫è': '-¬•8,350.00',
                        'Áõà‰∫èÊØî‰æã': '-5.26%',
                        'ÊåÅ‰ªìËÇ°Á•®': '8Âè™',
                        'ÊúÄÂ§ß‰∫èÊçü': 'ÂÆÅÂæ∑Êó∂‰ª£ -12.3%',
                        'È£éÈô©Á≠âÁ∫ß': '‰∏≠È´òÈ£éÈô©',
                        'Âª∫ËÆÆÊìç‰Ωú': 'ÂÖ≥Ê≥®Ê≠¢Êçü'
                    },
                    actions: [
                        { id: 'adjust', text: 'Ë∞ÉÊï¥‰ªì‰Ωç', type: 'primary' },
                        { id: 'view', text: 'Êü•ÁúãËØ¶ÊÉÖ', type: 'secondary' }
                    ]
                },
                {
                    id: 4,
                    type: 'trade',
                    title: '‰∫§ÊòìÈÄöÁü•',
                    message: 'ÊÇ®ÁöÑ‰π∞ÂÖ•ËÆ¢ÂçïÂ∑≤ÊàêÂäüÊâßË°åÔºöÂπ≥ÂÆâÈì∂Ë°å 1000ËÇ° @ ¬•12.50',
                    time: new Date(Date.now() - 60 * 60 * 1000),
                    read: true,
                    priority: 'medium'
                },
                {
                    id: 5,
                    type: 'system',
                    title: 'Á≥ªÁªüÈÄöÁü•',
                    message: 'ÊäïËµÑÂä©ÊâãÂ∑≤Êõ¥Êñ∞Ëá≥v2.1.0ÔºåÊñ∞Â¢ûÊô∫ËÉΩÊé®ËçêÂäüËÉΩ',
                    time: new Date(Date.now() - 2 * 60 * 60 * 1000),
                    read: false,
                    priority: 'low'
                }
            ];
        },

        // Êõ¥Êñ∞ÂàÜÁ±ªËÆ°Êï∞
        updateCategoryCounts() {
            this.categories.forEach(category => {
                if (category.id === 'all') {
                    category.count = this.unreadCount;
                } else {
                    category.count = this.notifications.filter(n =>
                        n.type === category.id && !n.read
                    ).length;
                }
            });
        },

        // ÊâìÂºÄÈÄöÁü•
        openNotification(notification) {
            this.selectedNotification = notification;
            this.showDetailDialog = true;
            // ‰∏çÁ´ãÂç≥Ê†áËÆ∞‰∏∫Â∑≤ËØªÔºåËÆ©Áî®Êà∑Âú®ËØ¶ÊÉÖÈ°µÈù¢ÂÜ≥ÂÆö
        },

        // Ê†áËÆ∞Â∑≤ËØª
        markAsRead(notification) {
            if (!notification.read) {
                notification.read = true;
                this.updateCategoryCounts();
                this.showToast('Â∑≤Ê†áËÆ∞‰∏∫Â∑≤ËØª', 'success');
            }
        },

        // Â§ÑÁêÜÊìç‰Ωú
        handleAction(notification, action) {
            this.markAsRead(notification);
            this.$emit('action-click', { notification, action });
        },

        // ÂÖ®ÈÉ®Â∑≤ËØª
        markAllAsRead() {
            const unreadNotifications = this.notifications.filter(n => !n.read);
            if (unreadNotifications.length === 0) {
                this.showToast('Ê≤°ÊúâÊú™ËØªÈÄöÁü•');
                return;
            }

            unreadNotifications.forEach(n => n.read = true);
            this.updateCategoryCounts();
            this.showToast(`Â∑≤Ê†áËÆ∞${unreadNotifications.length}Êù°ÈÄöÁü•‰∏∫Â∑≤ËØª`, 'success');
        },

        // ÊâìÂºÄËÆæÁΩÆ
        openSettings() {
            this.showSettingsDialog = true;
            // Âª∂ËøüÊ£ÄÊü•ÊòØÂê¶ÈúÄË¶ÅÊòæÁ§∫ÊªöÂä®ÊåáÁ§∫Âô®
            this.$nextTick(() => {
                this.checkScrollIndicator();
            });
        },

        // ÂÖ≥Èó≠ËÆæÁΩÆÂºπÁ™ó
        closeSettings() {
            this.showSettingsDialog = false;
            this.showScrollIndicator = false;
        },

        // Ê£ÄÊü•ÊòØÂê¶ÈúÄË¶ÅÊòæÁ§∫ÊªöÂä®ÊåáÁ§∫Âô®
        checkScrollIndicator() {
            const content = document.querySelector('.settings-content');
            if (content) {
                const hasScroll = content.scrollHeight > content.clientHeight;
                const isAtTop = content.scrollTop === 0;
                this.showScrollIndicator = hasScroll && isAtTop;
            }
        },

        // Â§ÑÁêÜÂÜÖÂÆπÊªöÂä®
        handleContentScroll(e) {
            const content = e.target;
            const hasScroll = content.scrollHeight > content.clientHeight;
            const isAtTop = content.scrollTop === 0;
            const isNearBottom = content.scrollTop >= content.scrollHeight - content.clientHeight - 10;

            // Âè™Âú®È°∂ÈÉ®‰∏îÊúâÊõ¥Â§öÂÜÖÂÆπÊó∂ÊòæÁ§∫ÊåáÁ§∫Âô®
            this.showScrollIndicator = hasScroll && isAtTop;

            // Â¶ÇÊûúÊªöÂä®Âà∞Â∫ïÈÉ®ÔºåÈöêËóèÊåáÁ§∫Âô®
            if (isNearBottom) {
                this.showScrollIndicator = false;
            }
        },

        // ÊªöÂä®Âà∞Êõ¥Â§öÂÜÖÂÆπ
        scrollToMore() {
            const content = document.querySelector('.settings-content');
            if (content) {
                content.scrollTo({
                    top: 200,
                    behavior: 'smooth'
                });
            }
        },

        // ÊÅ¢Â§çÈªòËÆ§ËÆæÁΩÆ
        resetSettings() {
            this.settings = {
                market: true,
                news: true,
                alert: true,
                system: true,
                trade: true,
                startTime: '09:00',
                endTime: '21:00',
                doNotDisturb: false,
                frequency: 'realtime'
            };
            this.showToast('ËÆæÁΩÆÂ∑≤ÈáçÁΩÆÈªòËÆ§', 'success');
        },

        // ‰øùÂ≠òËÆæÁΩÆ
        saveSettings() {
            localStorage.setItem('pushSettings', JSON.stringify(this.settings));
            this.showToast('ËÆæÁΩÆÂ∑≤‰øùÂ≠ò', 'success');
            this.closeSettings();
        },

        // Âä†ËΩΩËÆæÁΩÆ
        loadSettings() {
            const savedSettings = localStorage.getItem('pushSettings');
            if (savedSettings) {
                try {
                    this.settings = { ...this.settings, ...JSON.parse(savedSettings) };
                } catch (error) {
                    console.error('Âä†ËΩΩËÆæÁΩÆÂ§±Ë¥•:', error);
                }
            }
        },

        // ÂÖ≥Èó≠ËØ¶ÊÉÖÂºπÁ™ó
        closeDetail() {
            this.showDetailDialog = false;
            this.selectedNotification = null;
        },

        // Ê†áËÆ∞Â∑≤ËØªÂπ∂ÂÖ≥Èó≠ËØ¶ÊÉÖ
        markAsReadAndClose() {
            if (this.selectedNotification && !this.selectedNotification.read) {
                this.markAsRead(this.selectedNotification);
            }
            this.closeDetail();
        },

        // Â§ÑÁêÜËØ¶ÊÉÖÈ°µÈù¢ÁöÑÊìç‰ΩúÊåâÈíÆ
        handleDetailAction(notification, action) {
            this.markAsRead(notification);
            this.$emit('action-click', { notification, action });
            this.closeDetail();
        },

        // ËØ¶ÊÉÖÂºπÁ™óËß¶Êë∏Â§ÑÁêÜ - ÊîØÊåÅ‰∏ãÊãâÂÖ≥Èó≠
        handleDetailTouchStart(e) {
            this.detailTouchStartY = e.touches[0].clientY;
            this.detailTouchStartTime = Date.now();
        },

        handleDetailTouchMove(e) {
            if (!this.detailTouchStartY) return;

            const currentY = e.touches[0].clientY;
            const deltaY = currentY - this.detailTouchStartY;

            // Âè™ÂÖÅËÆ∏Âêë‰∏ãÊãñÊãΩÂÖ≥Èó≠ÂºπÁ™ó
            if (deltaY > 0) {
                e.preventDefault();
                const dialog = document.querySelector('.detail-dialog');
                const translateY = Math.min(deltaY * 0.5, 100);
                dialog.style.transform = `translateY(${translateY}px)`;
                dialog.style.opacity = Math.max(1 - deltaY / 300, 0.5);
            }
        },

        handleDetailTouchEnd(e) {
            if (!this.detailTouchStartY) return;

            const currentY = e.changedTouches[0].clientY;
            const deltaY = currentY - this.detailTouchStartY;
            const deltaTime = Date.now() - this.detailTouchStartTime;
            const dialog = document.querySelector('.detail-dialog');

            // ÈáçÁΩÆÊ†∑Âºè
            if (dialog) {
                dialog.style.transform = '';
                dialog.style.opacity = '';
            }

            // Âà§Êñ≠ÊòØÂê¶Â∫îËØ•ÂÖ≥Èó≠ÂºπÁ™ó
            const shouldClose = deltaY > 100 || (deltaY > 50 && deltaTime < 300);

            if (shouldClose) {
                this.closeDetail();
            }

            this.detailTouchStartY = null;
            this.detailTouchStartTime = null;
        },

        // Ëß¶Êë∏Â§ÑÁêÜ - ÊîØÊåÅ‰∏ãÊãâÂÖ≥Èó≠Ôºà‰ªÖÂú®ÊãñÊãΩÊåáÁ§∫Âô®‰∏äÔºâ
        handleTouchStart(e) {
            this.touchStartY = e.touches[0].clientY;
            this.touchStartTime = Date.now();
        },

        handleTouchMove(e) {
            if (!this.touchStartY) return;

            const currentY = e.touches[0].clientY;
            const deltaY = currentY - this.touchStartY;

            // Âè™ÂÖÅËÆ∏Âêë‰∏ãÊãñÊãΩÂÖ≥Èó≠ÂºπÁ™ó
            if (deltaY > 0) {
                e.preventDefault();
                const dialog = document.querySelector('.settings-dialog');
                const translateY = Math.min(deltaY * 0.5, 100);
                dialog.style.transform = `translateY(${translateY}px)`;
                dialog.style.opacity = Math.max(1 - deltaY / 300, 0.5);
            }
        },

        handleTouchEnd(e) {
            if (!this.touchStartY) return;

            const currentY = e.changedTouches[0].clientY;
            const deltaY = currentY - this.touchStartY;
            const deltaTime = Date.now() - this.touchStartTime;
            const dialog = document.querySelector('.settings-dialog');

            // ÈáçÁΩÆÊ†∑Âºè
            if (dialog) {
                dialog.style.transform = '';
                dialog.style.opacity = '';
            }

            // Âà§Êñ≠ÊòØÂê¶Â∫îËØ•ÂÖ≥Èó≠ÂºπÁ™ó
            const shouldClose = deltaY > 100 || (deltaY > 50 && deltaTime < 300);

            if (shouldClose) {
                this.closeSettings();
            }

            this.touchStartY = null;
            this.touchStartTime = null;
        },

        // Âä†ËΩΩÊõ¥Â§ö
        async loadMore() {
            if (this.isLoading) return;
            this.isLoading = true;

            try {
                await new Promise(resolve => setTimeout(resolve, 800));
                const moreNotifications = this.generateMoreNotifications();

                if (moreNotifications.length > 0) {
                    moreNotifications.forEach(notification => {
                        notification.isNew = true;
                    });

                    this.notifications.push(...moreNotifications);
                    this.updateCategoryCounts();
                    this.showToast(`Âä†ËΩΩ‰∫Ü${moreNotifications.length}Êù°Êñ∞Ê∂àÊÅØ`, 'success');

                    setTimeout(() => {
                        moreNotifications.forEach(notification => {
                            notification.isNew = false;
                        });
                    }, 1000);
                } else {
                    this.hasMore = false;
                    this.showToast('Â∑≤ÊòæÁ§∫ÂÖ®ÈÉ®ÈÄöÁü•');
                }
            } catch (error) {
                this.showToast('Âä†ËΩΩÂ§±Ë¥•ÔºåËØ∑ÈáçËØï', 'error');
            } finally {
                this.isLoading = false;
            }
        },

        // ÁîüÊàêÊõ¥Â§öÈÄöÁü•Êï∞ÊçÆ
        generateMoreNotifications() {
            if (this.notifications.length >= 15) {
                return [];
            }

            const types = ['market', 'news', 'alert', 'trade', 'system'];
            const priorities = ['urgent', 'high', 'medium', 'low'];
            const moreNotifications = [];
            const count = Math.floor(Math.random() * 3) + 3;

            for (let i = 0; i < count; i++) {
                const type = types[Math.floor(Math.random() * types.length)];
                const priority = priorities[Math.floor(Math.random() * priorities.length)];
                const isRead = Math.random() > 0.7;

                const notification = {
                    id: Date.now() + i,
                    type,
                    priority,
                    read: isRead,
                    title: this.getRandomTitle(type),
                    message: this.getRandomMessage(type),
                    time: new Date(Date.now() - Math.random() * 24 * 60 * 60 * 1000),
                    actions: this.getRandomActions(type)
                };

                moreNotifications.push(notification);
            }

            return moreNotifications;
        },

        // Ëé∑ÂèñÈöèÊú∫Ê†áÈ¢ò
        getRandomTitle(type) {
            const titles = {
                market: ['ËÇ°‰ª∑ÂºÇÂä®', 'ÊùøÂùóËΩÆÂä®', 'ËµÑÈáëÊµÅÂêë', 'ÊäÄÊúØÁ™ÅÁ†¥', 'Èáè‰ª∑ÂàÜÊûê'],
                news: ['ÊîøÁ≠ñËß£ËØª', 'Ë¥¢ÁªèË¶ÅÈóª', 'ÂÖ¨Âè∏ÂÖ¨Âëä', 'Ë°å‰∏öÂä®ÊÄÅ', 'ÂÆèËßÇÊï∞ÊçÆ'],
                alert: ['È£éÈô©ÊèêÈÜí', '‰ª∑Ê†ºÈ¢ÑË≠¶', 'Ê≠¢ÊçüÊèêÁ§∫', 'Ê≥¢Âä®Ë≠¶Âëä', 'ËµÑÈáëÈ¢ÑË≠¶'],
                trade: ['‰∫§ÊòìÊèêÈÜí', 'ÂßîÊâòÁä∂ÊÄÅ', 'Êàê‰∫§ÂõûÊä•', 'ËµÑÈáëÂèòÂä®', 'ÊåÅ‰ªìË∞ÉÊï¥'],
                system: ['Á≥ªÁªüÈÄöÁü•', 'ÂäüËÉΩÊõ¥Êñ∞', 'Áª¥Êä§ÂÖ¨Âëä', 'ÊúçÂä°ÂçáÁ∫ß', 'ÂÆâÂÖ®ÊèêÈÜí']
            };
            const typeList = titles[type] || titles.system;
            return typeList[Math.floor(Math.random() * typeList.length)];
        },

        // Ëé∑ÂèñÈöèÊú∫Ê∂àÊÅØ
        getRandomMessage(type) {
            const messages = {
                market: [
                    'ÁßëÊäÄÊùøÂùóÂº∫ÂäøÊãâÂçáÔºåÂª∫ËÆÆÂÖ≥Ê≥®ÈæôÂ§¥ËÇ°Êú∫‰ºö',
                    'Èì∂Ë°åËÇ°ÈõÜ‰Ωì‰∏äÊ∂®ÔºåËµÑÈáëÈù¢ÂÆΩÊùæÈ¢ÑÊúüÂ¢ûÂº∫',
                    'Êñ∞ËÉΩÊ∫êÊùøÂùóË∞ÉÊï¥ÔºåÂÖ≥Ê≥®‰Ωé‰ΩçÂ∏ÉÂ±ÄÊú∫‰ºö',
                    'ÂåªËçØËÇ°ÂàÜÂåñÊòéÊòæÔºåÁ≤æÈÄâ‰∏™ËÇ°ÊòØÂÖ≥ÈîÆ',
                    'Ê∂àË¥πÊùøÂùó‰ºÅÁ®≥ÂõûÂçáÔºåÂÖ≥Ê≥®‰∏öÁª©Á°ÆÂÆöÊÄß'
                ],
                news: [
                    'Â§ÆË°åÈôçÂáÜÈáäÊîæÈïøÊúüËµÑÈáëÔºåÂà©Â•ΩËÇ°Â∏ÇË°®Áé∞',
                    'Êñ∞ÊîøÁ≠ñÂá∫Âè∞ÊîØÊåÅÂÆû‰ΩìÁªèÊµéÔºåÁõ∏ÂÖ≥ÊùøÂùóÂèóÁõä',
                    'ÈáçË¶ÅÁªèÊµéÊï∞ÊçÆÂÖ¨Â∏ÉÔºåË∂ÖÂá∫Â∏ÇÂú∫È¢ÑÊúü',
                    'ÂõΩÈôÖÂ∏ÇÂú∫Ê≥¢Âä®Âä†ÂâßÔºåÈúÄÂÖ≥Ê≥®È£éÈô©‰º†ÂØº',
                    'Ë°å‰∏öÁõëÁÆ°ÊîøÁ≠ñË∞ÉÊï¥ÔºåÂΩ±ÂìçÁõ∏ÂÖ≥ÂÖ¨Âè∏‰º∞ÂÄº'
                ],
                alert: [
                    'ÊÇ®ÁöÑÊäïËµÑÁªÑÂêàÊ≥¢Âä®ËæÉÂ§ßÔºåÂª∫ËÆÆÈÄÇÂΩìË∞ÉÊï¥',
                    'ÊåÅ‰ªìËÇ°Á•®Êé•ËøëÊ≠¢Êçü‰ΩçÔºåËØ∑Ê≥®ÊÑèÈ£éÈô©ÊéßÂà∂',
                    'Ë¥¶Êà∑ËµÑÈáë‰ΩøÁî®ÁéáËøáÈ´òÔºåÂª∫ËÆÆÂêàÁêÜÈÖçÁΩÆ',
                    'Â∏ÇÂú∫Ê≥¢Âä®Âä†ÂâßÔºåÂª∫ËÆÆÈôç‰Ωé‰ªì‰Ωç',
                    '‰∏™ËÇ°ÈõÜ‰∏≠Â∫¶ËøáÈ´òÔºåÂª∫ËÆÆÂàÜÊï£ÊäïËµÑ'
                ],
                trade: [
                    'ÊÇ®ÁöÑ‰π∞ÂÖ•ËÆ¢ÂçïÂ∑≤ÊàêÂäüÊâßË°å',
                    'ÂçñÂá∫ËÆ¢ÂçïÈÉ®ÂàÜÊàê‰∫§ÔºåÂâ©‰ΩôÊï∞ÈáèÁªßÁª≠ÊåÇÂçï',
                    'ÂßîÊâòËÆ¢ÂçïÂ∑≤Êí§ÈîÄÔºåËµÑÈáëÂ∑≤Ëß£ÂÜª',
                    'ÂàÜÁ∫¢Ê¥æÊÅØÂà∞Ë¥¶ÔºåËØ∑Êü•Êî∂',
                    'Êñ∞ËÇ°Áî≥Ë¥≠ÁªìÊûúÂÖ¨Â∏ÉÔºåÊÅ≠Âñú‰∏≠Á≠æ'
                ],
                system: [
                    'ÊäïËµÑÂä©ÊâãÊñ∞Â¢ûÊô∫ËÉΩÂàÜÊûêÂäüËÉΩ',
                    'Á≥ªÁªüÂ∞Ü‰∫é‰ªäÊôöËøõË°å‰æãË°åÁª¥Êä§',
                    'Êñ∞ÁâàÊú¨Â∑≤ÂèëÂ∏ÉÔºåËØ∑ÂèäÊó∂Êõ¥Êñ∞',
                    'Êé®ÈÄÅÊúçÂä°Â∑≤‰ºòÂåñÔºå‰ΩìÈ™åÊõ¥ÊµÅÁïÖ',
                    'Êï∞ÊçÆÊé•Âè£ÂçáÁ∫ßÂÆåÊàêÔºå‰ø°ÊÅØÊõ¥ÂèäÊó∂'
                ]
            };
            const typeList = messages[type] || messages.system;
            return typeList[Math.floor(Math.random() * typeList.length)];
        },

        // Ëé∑ÂèñÈöèÊú∫Êìç‰ΩúÊåâÈíÆ
        getRandomActions(type) {
            const actions = {
                market: [
                    [
                        { id: 'view', text: 'Êü•ÁúãËØ¶ÊÉÖ', type: 'primary' },
                        { id: 'trade', text: 'Á´ãÂç≥‰∫§Êòì', type: 'secondary' }
                    ]
                ],
                alert: [
                    [
                        { id: 'adjust', text: 'Êü•ÁúãËØ¶ÊÉÖ', type: 'primary' }
                    ]
                ],
                trade: [
                    [
                        { id: 'view', text: 'Êü•ÁúãËØ¶ÊÉÖ', type: 'primary' }
                    ]
                ]
            };
            const typeActions = actions[type];
            if (typeActions) {
                return typeActions[Math.floor(Math.random() * typeActions.length)];
            }
            return null;
        },

        // Ê£ÄÊü•ÊùÉÈôê
        checkPermission() {
            if ('Notification' in window && Notification.permission === 'default') {
                this.showPermissionTip = true;
            }
        },

        // ËØ∑Ê±ÇÊùÉÈôê
        async requestPermission() {
            if ('Notification' in window) {
                const permission = await Notification.requestPermission();
                if (permission === 'granted') {
                    this.showToast('ÈÄöÁü•ÊùÉÈôêÂ∑≤ÂºÄÂêØ', 'success');
                } else {
                    this.showToast('ÈÄöÁü•ÊùÉÈôêË¢´ÊãíÁªù', 'error');
                }
            }
            this.showPermissionTip = false;
        },

        // Ëé∑ÂèñÁ±ªÂûãÂõæÊ†á
        getTypeIcon(type) {
            const icons = {
                market: 'üìà',
                news: 'üì∞',
                alert: '‚ö†Ô∏è',
                trade: 'üí∞',
                system: '‚öôÔ∏è'
            };
            return icons[type] || 'üì¨';
        },

        // Ê†ºÂºèÂåñÊó∂Èó¥
        formatTime(time) {
            const now = new Date();
            const diff = now - time;
            const minutes = Math.floor(diff / 60000);
            const hours = Math.floor(diff / 3600000);
            const days = Math.floor(diff / 86400000);

            if (minutes < 1) return 'ÂàöÂàö';
            if (minutes < 60) return `${minutes}ÂàÜÈíüÂâç`;
            if (hours < 24) return `${hours}Â∞èÊó∂Ââç`;
            if (days < 7) return `${days}Â§©Ââç`;

            return time.toLocaleDateString();
        },

        // ÊòæÁ§∫Toast
        showToast(message, type = 'info') {
            this.toast = { show: true, message, type };
            setTimeout(() => {
                this.toast.show = false;
            }, 3000);
        }
    }
};
</script>

<style scoped>
/* Âü∫Á°ÄÂÆπÂô® */
.mobile-push-container {
    height: 100%;
    display: flex;
    flex-direction: column;
    background: white;
    overflow: hidden;
}

/* Â§¥ÈÉ®Ê†∑Âºè */
.push-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 8px 12px;
    border-bottom: 1px solid #f0f0f0;
    background: #ffffff;
}

.push-header h3 {
    margin: 0;
    font-size: 14px;
    font-weight: 600;
    color: #1a1a1a;
}

.header-actions {
    display: flex;
    align-items: center;
    gap: 6px;
}

.action-btn {
    display: flex;
    align-items: center;
    gap: 4px;
    padding: 4px 8px;
    background: #f8f9fa;
    border: 1px solid #e9ecef;
    border-radius: 4px;
    color: #6c757d;
    font-size: 11px;
    cursor: pointer;
    transition: all 0.2s ease;
}

.action-btn:hover {
    background: #e9ecef;
    color: #495057;
}

.settings-btn {
    padding: 4px;
}

/* ÂàÜÁ±ªÊ†áÁ≠æ */
.notification-categories {
    padding: 8px 0;
    border-bottom: 1px solid #f0f0f0;
}

.category-scroll {
    display: flex;
    gap: 6px;
    padding: 0 12px;
    overflow-x: auto;
    scrollbar-width: none;
    -ms-overflow-style: none;
}

.category-scroll::-webkit-scrollbar {
    display: none;
}

.category-btn {
    display: flex;
    align-items: center;
    gap: 4px;
    padding: 4px 8px;
    background: #f8f9fa;
    border: 1px solid #e9ecef;
    border-radius: 12px;
    color: #6c757d;
    font-size: 11px;
    white-space: nowrap;
    cursor: pointer;
    transition: all 0.2s ease;
}

.category-btn.active {
    background: #007bff;
    border-color: #007bff;
    color: white;
}

.category-icon {
    font-size: 12px;
}

.category-count {
    background: rgba(255, 255, 255, 0.2);
    color: inherit;
    padding: 1px 4px;
    border-radius: 8px;
    font-size: 10px;
    font-weight: 600;
    min-width: 14px;
    text-align: center;
}

.category-btn:not(.active) .category-count {
    background: #dc3545;
    color: white;
}

/* ÈÄöÁü•ÂÆπÂô® */
.notifications-container {
    flex: 1;
    overflow-y: auto;
    padding: 8px 0;
}

/* ‰∏ãÊãâÂà∑Êñ∞ */
.refresh-indicator {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    padding: 12px;
    color: #6c757d;
    font-size: 12px;
}

.refresh-spinner {
    width: 16px;
    height: 16px;
    border: 2px solid #e9ecef;
    border-top: 2px solid #007bff;
    border-radius: 50%;
    animation: spin 1s linear infinite;
}

/* ÈÄöÁü•ÂàóË°® */
.notifications-list {
    padding: 0 8px;
}

.notification-card {
    background: white;
    border: 1px solid #e9ecef;
    border-radius: 8px;
    margin-bottom: 8px;
    transition: all 0.2s ease;
    cursor: pointer;
}

.notification-card:hover {
    border-color: #007bff;
    box-shadow: 0 2px 8px rgba(0, 123, 255, 0.1);
}

.notification-card.unread {
    border-left: 3px solid #007bff;
    background: #f8f9ff;
}

.notification-card.urgent {
    border-left-color: #dc3545;
}

.notification-card.new-message {
    animation: slideInFade 0.5s ease;
    background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%);
}

.notification-content {
    padding: 10px 12px;
}

.notification-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 6px;
}

.app-info {
    display: flex;
    align-items: center;
    gap: 8px;
}

.app-icon {
    width: 24px;
    height: 24px;
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
}

.app-icon.market {
    background: #e3f2fd;
}

.app-icon.news {
    background: #fff3e0;
}

.app-icon.alert {
    background: #ffebee;
}

.app-icon.trade {
    background: #e8f5e8;
}

.app-icon.system {
    background: #f3e5f5;
}

.meta {
    display: flex;
    flex-direction: column;
    gap: 1px;
}

.app-name {
    font-size: 11px;
    font-weight: 500;
    color: #6c757d;
}

.time {
    font-size: 10px;
    color: #adb5bd;
}

.unread-dot {
    width: 6px;
    height: 6px;
    background: #007bff;
    border-radius: 50%;
}

.notification-body {
    margin-bottom: 8px;
}

.title {
    font-size: 13px;
    font-weight: 600;
    color: #212529;
    margin: 0 0 4px 0;
}

.message {
    font-size: 12px;
    color: #6c757d;
    margin: 0;
    line-height: 1.4;
}

.actions {
    display: flex;
    gap: 6px;
    flex-wrap: wrap;
}

.action-button {
    padding: 3px 8px;
    border: 1px solid #e9ecef;
    border-radius: 4px;
    background: white;
    color: #6c757d;
    font-size: 10px;
    cursor: pointer;
    transition: all 0.2s ease;
}

.action-button.primary {
    background: #007bff;
    border-color: #007bff;
    color: white;
}

.action-button.secondary {
    background: #6c757d;
    border-color: #6c757d;
    color: white;
}

.action-button:hover {
    opacity: 0.8;
}

/* Á©∫Áä∂ÊÄÅ */
.empty-state {
    text-align: center;
    padding: 40px 20px;
    color: #6c757d;
}

.empty-icon {
    font-size: 48px;
    margin-bottom: 12px;
}

.empty-text {
    font-size: 14px;
    font-weight: 500;
    margin: 0 0 4px 0;
}

.empty-desc {
    font-size: 12px;
    margin: 0;
    opacity: 0.7;
}

/* Âä†ËΩΩÊõ¥Â§ö */
.load-more {
    padding: 16px;
    text-align: center;
}

.load-more-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    padding: 8px 16px;
    background: #f9fafb;
    border: 1px solid #e5e7eb;
    border-radius: 6px;
    color: #6b7280;
    font-size: 12px;
    cursor: pointer;
    transition: all 0.2s ease;
    width: 100%;
}

.load-more-btn:hover:not(:disabled) {
    background: #f3f4f6;
}

.load-more-btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
}

.loading-spinner {
    width: 12px;
    height: 12px;
    border: 1px solid #e5e7eb;
    border-top: 1px solid #6b7280;
    border-radius: 50%;
    animation: spin 1s linear infinite;
}

/* Âä†ËΩΩÂÆåÊØïÊèêÁ§∫ */
.load-complete {
    padding: 16px;
    text-align: center;
    color: #9ca3af;
    font-size: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
}

.complete-icon {
    color: #10b981;
    font-weight: bold;
}

/* ÊùÉÈôêÊèêÁ§∫ */
.permission-tip {
    position: fixed;
    top: 16px;
    left: 16px;
    right: 16px;
    z-index: 1000;
}

.tip-content {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 12px 16px;
    background: #fef3c7;
    border: 1px solid #fbbf24;
    border-radius: 8px;
    color: #92400e;
    font-size: 12px;
}

.tip-icon {
    font-size: 16px;
    flex-shrink: 0;
}

.tip-text {
    flex: 1;
}

.tip-btn {
    padding: 4px 8px;
    background: #f59e0b;
    color: #ffffff;
    border: none;
    border-radius: 4px;
    font-size: 11px;
    cursor: pointer;
}

.tip-close {
    background: none;
    border: none;
    color: #92400e;
    cursor: pointer;
    font-size: 14px;
    padding: 0;
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
}

/* ToastÊèêÁ§∫ */
.toast {
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0, 0, 0, 0.8);
    color: #ffffff;
    padding: 8px 16px;
    border-radius: 16px;
    font-size: 12px;
    z-index: 1001;
    animation: slideUp 0.3s ease;
}

.toast.success {
    background: rgba(34, 197, 94, 0.9);
}

.toast.error {
    background: rgba(239, 68, 68, 0.9);
}

.toast.info {
    background: rgba(59, 130, 246, 0.9);
}

/* ËÆæÁΩÆÂºπÁ™óÊ†∑Âºè */
.settings-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.5);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 9999;
    padding: 20px;
    animation: fade-in 0.3s ease;
}

.settings-dialog {
    background: white;
    border-radius: 12px;
    width: 100%;
    max-width: 380px;
    max-height: 75vh;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    animation: slide-up 0.3s ease;
}

/* ÊãñÊãΩÊåáÁ§∫Âô® */
.drag-indicator {
    display: none;
}

/* ÁßªÂä®Á´ØÂÖ®Â±èÊ®°Âºè */
@media (max-width: 768px) {
    .settings-overlay {
        padding: 0;
        align-items: flex-end;
    }

    .settings-dialog {
        max-width: 100%;
        max-height: 90vh;
        border-radius: 16px 16px 0 0;
        animation: slide-up-mobile 0.3s ease;
        position: relative;
    }

    .drag-indicator {
        display: block;
        width: 40px;
        height: 4px;
        background: #d1d5db;
        border-radius: 2px;
        margin: 8px auto;
        flex-shrink: 0;
        cursor: pointer;
        position: relative;
        /* ‰ΩøÁî®‰º™ÂÖÉÁ¥†Â¢ûÂä†Ëß¶Êë∏Âå∫ÂüüËÄå‰∏çÂΩ±ÂìçËßÜËßâ */
    }

    .drag-indicator::before {
        content: '';
        position: absolute;
        top: -8px;
        left: -8px;
        right: -8px;
        bottom: -8px;
        /* Â¢ûÂä†Ëß¶Êë∏Âå∫Âüü‰ΩÜ‰∏çÂΩ±ÂìçËßÜËßâÊòæÁ§∫ */
    }

    .settings-content {
        /* Á°Æ‰øùÂÜÖÂÆπÂå∫ÂüüÂèØ‰ª•ÊªöÂä® */
        max-height: calc(90vh - 120px) !important;
        /* ÂáèÂéªÂ§¥ÈÉ®ÂíåÂ∫ïÈÉ®ÁöÑÈ´òÂ∫¶ */
        overflow-y: scroll !important;
        /* Âº∫Âà∂ÊòæÁ§∫ÊªöÂä®Êù° */
        -webkit-overflow-scrolling: touch !important;
        /* iOSÂπ≥ÊªëÊªöÂä® */
    }

    .settings-header {
        flex-shrink: 0;
        /* Èò≤Ê≠¢Â§¥ÈÉ®Ë¢´ÂéãÁº© */
    }

    .settings-footer {
        flex-shrink: 0;
        /* Èò≤Ê≠¢Â∫ïÈÉ®Ë¢´ÂéãÁº© */
    }
}

.settings-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 16px;
    border-bottom: 1px solid #f0f0f0;
    background: #f8f9fa;
}

.settings-title {
    font-size: 16px;
    font-weight: 600;
    color: #1a1a1a;
    margin: 0;
}

.settings-close {
    background: none;
    border: none;
    color: #666;
    cursor: pointer;
    padding: 4px;
    border-radius: 4px;
    transition: all 0.2s ease;
}

.settings-close:hover {
    background: #e9ecef;
    color: #333;
}

.settings-content {
    flex: 1;
    overflow-y: auto;
    padding: 0;
    -webkit-overflow-scrolling: touch;
    /* iOSÂπ≥ÊªëÊªöÂä® */
    overscroll-behavior: contain;
    /* Èò≤Ê≠¢ÊªöÂä®Á©øÈÄè */
}

.setting-section {
    padding: 0 16px;
}

.section-title {
    font-size: 13px;
    font-weight: 600;
    color: #666;
    margin: 12px 0 8px 0;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.setting-item {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    padding: 12px 16px;
    border-bottom: 1px solid #f5f5f5;
}

.setting-item:last-child {
    border-bottom: none;
}

.setting-info {
    flex: 1;
    margin-right: 12px;
}

.setting-label {
    font-size: 14px;
    font-weight: 500;
    color: #1a1a1a;
    margin: 0 0 2px 0;
}

.setting-desc {
    font-size: 12px;
    color: #666;
    margin: 0;
    line-height: 1.4;
}

.setting-control {
    flex-shrink: 0;
}

.toggle-switch {
    position: relative;
    display: inline-block;
    width: 48px;
    height: 28px;
}

.toggle-switch input {
    opacity: 0;
    width: 0;
    height: 0;
}

.toggle-slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: #ccc;
    border-radius: 28px;
    transition: 0.3s;
}

.toggle-slider:before {
    position: absolute;
    content: "";
    height: 22px;
    width: 22px;
    left: 3px;
    bottom: 3px;
    background: white;
    border-radius: 50%;
    transition: 0.3s;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

input:checked+.toggle-slider {
    background: #007bff;
}

input:checked+.toggle-slider:before {
    transform: translateX(20px);
}

input:disabled+.toggle-slider {
    opacity: 0.5;
    cursor: not-allowed;
}

.settings-divider {
    height: 1px;
    background: #f0f0f0;
    margin: 0 16px;
}

.time-range {
    display: flex;
    gap: 12px;
    padding: 8px 16px 0;
}

.time-input {
    flex: 1;
}

.time-input label {
    display: block;
    font-size: 12px;
    color: #666;
    margin-bottom: 4px;
}

.time-picker {
    width: 100%;
    padding: 6px 10px;
    border: 1px solid #ddd;
    border-radius: 6px;
    font-size: 13px;
    background: white;
}

.time-picker:focus {
    outline: none;
    border-color: #007bff;
    box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);
}

.frequency-options {
    display: flex;
    flex-direction: column;
    gap: 8px;
    padding: 0 16px;
}

.frequency-option {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 10px 12px;
    background: #f8fafc;
    border-radius: 6px;
    border: 1px solid #e2e8f0;
    cursor: pointer;
    transition: all 0.2s ease;
}

.frequency-option:hover {
    background: #f1f5f9;
    border-color: #cbd5e1;
}

.frequency-option:has(.frequency-radio:checked) {
    background: #eff6ff;
    border-color: #3b82f6;
}

.frequency-radio {
    margin: 0;
    accent-color: #3b82f6;
}

.frequency-content {
    flex: 1;
}

.frequency-label {
    font-size: 14px;
    font-weight: 500;
    color: #1a1a1a;
    margin-bottom: 2px;
    display: block;
}

.frequency-desc {
    font-size: 12px;
    color: #64748b;
    display: block;
}

.scroll-indicator {
    position: absolute;
    bottom: 60px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 10;
    pointer-events: auto;
    cursor: pointer;
}

.scroll-hint {
    display: flex;
    align-items: center;
    gap: 4px;
    padding: 6px 12px;
    background: rgba(0, 0, 0, 0.7);
    color: white;
    border-radius: 16px;
    font-size: 11px;
    animation: bounce 2s infinite;
}

.settings-footer {
    display: flex;
    gap: 10px;
    padding: 12px 16px;
    border-top: 1px solid #f0f0f0;
    background: #f8f9fa;
}

.reset-btn,
.save-btn {
    flex: 1;
    padding: 8px 14px;
    border: none;
    border-radius: 6px;
    font-size: 13px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s ease;
}

.reset-btn {
    background: #f8f9fa;
    color: #666;
    border: 1px solid #ddd;
}

.reset-btn:hover {
    background: #e9ecef;
    color: #333;
}

.save-btn {
    background: #007bff;
    color: white;
}

.save-btn:hover {
    background: #0056b3;
}

/* Âä®Áîª */
@keyframes spin {
    0% {
        transform: rotate(0deg);
    }

    100% {
        transform: rotate(360deg);
    }
}

@keyframes slideUp {
    from {
        opacity: 0;
        transform: translateX(-50%) translateY(20px);
    }

    to {
        opacity: 1;
        transform: translateX(-50%) translateY(0);
    }
}

@keyframes slideInFade {
    0% {
        opacity: 0;
        transform: translateY(-10px) scale(0.98);
    }

    50% {
        opacity: 0.8;
        transform: translateY(-2px) scale(1.01);
    }

    100% {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

@keyframes fade-in {
    from {
        opacity: 0;
    }

    to {
        opacity: 1;
    }
}

@keyframes slide-up {
    from {
        opacity: 0;
        transform: translateY(20px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes slide-up-mobile {
    from {
        opacity: 0;
        transform: translateY(100%);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes bounce {

    0%,
    20%,
    50%,
    80%,
    100% {
        transform: translateY(0);
    }

    40% {
        transform: translateY(-4px);
    }

    60% {
        transform: translateY(-2px);
    }
}

/* ÁßªÂä®Á´Ø‰ºòÂåñ */
@media (max-width: 768px) {
    .notification-card {
        margin: 0 8px 6px 8px;
    }

    .push-header {
        padding: 10px 12px;
    }

    .category-scroll {
        padding: 0 12px;
    }

    .notification-content {
        padding: 10px 12px;
    }

    .settings-overlay {
        padding: 8px;
    }

    .settings-dialog {
        max-height: 85vh;
        max-width: 100%;
    }

    .settings-header {
        padding: 10px 12px;
    }

    .settings-title {
        font-size: 15px;
    }

    .setting-item {
        padding: 10px 12px;
    }

    .settings-footer {
        padding: 10px 12px;
    }

    .time-range {
        padding: 6px 12px 0;
        flex-direction: column;
        gap: 8px;
    }

    .frequency-options {
        padding: 0 12px;
    }

    .setting-section {
        padding: 0 12px;
    }

    .settings-divider {
        margin: 0 12px;
    }
}

/* Ê∂àÊÅØËØ¶ÊÉÖÂºπÁ™óÊ†∑Âºè */
.detail-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.5);
    z-index: 9999;
    display: flex;
    align-items: flex-end;
    animation: fadeIn 0.3s ease;
}

.detail-dialog {
    width: 100%;
    max-height: 90vh;
    background: white;
    border-radius: 16px 16px 0 0;
    animation: slideUpDetail 0.3s ease;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

.detail-header {
    padding: 16px 20px 12px;
    border-bottom: 1px solid #f0f0f0;
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-shrink: 0;
}

.detail-app-info {
    display: flex;
    align-items: center;
    gap: 12px;
}

.detail-app-icon {
    width: 40px;
    height: 40px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 18px;
    font-weight: 600;
    color: white;
}

.detail-app-icon.market {
    background: linear-gradient(45deg, #10b981, #059669);
}

.detail-app-icon.news {
    background: linear-gradient(45deg, #3b82f6, #1d4ed8);
}

.detail-app-icon.alert {
    background: linear-gradient(45deg, #f59e0b, #d97706);
}

.detail-app-icon.trade {
    background: linear-gradient(45deg, #8b5cf6, #7c3aed);
}

.detail-app-icon.system {
    background: linear-gradient(45deg, #6b7280, #4b5563);
}

.detail-meta {
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.detail-app-name {
    font-size: 14px;
    font-weight: 600;
    color: #111827;
}

.detail-time {
    font-size: 12px;
    color: #6b7280;
}

.detail-close {
    width: 32px;
    height: 32px;
    border: none;
    background: #f3f4f6;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    color: #6b7280;
    transition: all 0.2s ease;
}

.detail-close:hover {
    background: #e5e7eb;
    color: #374151;
}

.detail-content {
    flex: 1;
    padding: 16px 20px;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
}

.detail-priority {
    margin-bottom: 12px;
}

.priority-badge.urgent {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    padding: 4px 8px;
    background: #fef2f2;
    color: #dc2626;
    border-radius: 12px;
    font-size: 12px;
    font-weight: 500;
}

.detail-title {
    font-size: 18px;
    font-weight: 600;
    color: #111827;
    margin: 0 0 8px 0;
    line-height: 1.4;
}

.detail-message {
    font-size: 14px;
    color: #374151;
    line-height: 1.5;
    margin-bottom: 16px;
}

.detail-extra {
    margin-bottom: 16px;
}

.extra-title {
    font-size: 14px;
    font-weight: 600;
    color: #111827;
    margin: 0 0 8px 0;
}

.extra-content {
    font-size: 13px;
    color: #4b5563;
    line-height: 1.5;
    background: #f9fafb;
    padding: 12px;
    border-radius: 8px;
    border-left: 3px solid #3b82f6;
}

.detail-data {
    margin-bottom: 16px;
}

.data-title {
    font-size: 14px;
    font-weight: 600;
    color: #111827;
    margin: 0 0 8px 0;
}

.data-list {
    background: #f9fafb;
    border-radius: 8px;
    padding: 12px;
}

.data-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 6px 0;
    border-bottom: 1px solid #e5e7eb;
}

.data-item:last-child {
    border-bottom: none;
}

.data-label {
    font-size: 13px;
    color: #6b7280;
    font-weight: 500;
}

.data-value {
    font-size: 13px;
    color: #111827;
    font-weight: 600;
}

.detail-footer {
    padding: 16px 20px;
    border-top: 1px solid #f0f0f0;
    display: flex;
    gap: 12px;
    flex-shrink: 0;
}

.detail-action-button {
    flex: 1;
    padding: 12px 16px;
    border: none;
    border-radius: 8px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s ease;
}

.detail-action-button.primary {
    background: #3b82f6;
    color: white;
}

.detail-action-button.primary:hover {
    background: #2563eb;
}

.detail-action-button.secondary {
    background: #f3f4f6;
    color: #374151;
}

.detail-action-button.secondary:hover {
    background: #e5e7eb;
}

@keyframes fadeIn {
    from {
        opacity: 0;
    }

    to {
        opacity: 1;
    }
}

@keyframes slideUpDetail {
    from {
        transform: translateY(100%);
    }

    to {
        transform: translateY(0);
    }
}
</style>
