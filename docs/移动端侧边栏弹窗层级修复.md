# 移动端侧边栏弹窗层级修复

## 问题描述

用户反馈：移动端的侧边栏操作按钮的弹窗都被侧边栏遮住了。

## 问题分析

通过代码分析发现，移动端侧边栏和各种弹窗组件的z-index层级设置不合理：

### 原始层级设置

- **移动端侧边栏容器**: `z-index: 10001`
- **侧边栏关闭按钮**: `z-index: 10002`
- **侧边栏遮罩层**: `z-index: 9998`
- **各种弹窗组件**: `z-index: 9999` 或更低

### 问题根因

侧边栏的z-index（10001）高于大部分弹窗组件的z-index（9999），导致从侧边栏中触发的弹窗被侧边栏本身遮挡。

## 修复方案

### 1. 降低侧边栏层级

将移动端侧边栏的z-index降低，为弹窗留出显示空间：

```css
/* 修改前 */
.sidebar-container {
  z-index: 10001 !important;
}

/* 修改后 */
.sidebar-container {
  z-index: 9000 !important;
  /* 降低侧边栏z-index，确保弹窗能在其上方显示 */
}
```

### 2. 调整相关组件层级

同步调整侧边栏相关组件的z-index：

```css
/* 侧边栏关闭按钮 */
.mobile-close-btn {
  z-index: 9001 !important;
  /* 调整关闭按钮z-index与侧边栏保持一致 */
}

/* 侧边栏遮罩层 */
.sidebar-overlay {
  z-index: 8999 !important;
  /* 降低遮罩层z-index，确保弹窗能在其上方显示 */
}
```

### 3. 统一弹窗层级标准

为所有弹窗组件设置统一的高层级z-index：

#### Element Plus弹窗组件

```css
/* 通用Element Plus弹窗设置 */
:deep(.el-dialog) {
  z-index: 10000 !important;
}

:deep(.el-overlay) {
  z-index: 9999 !important;
}
```

#### 原生弹窗组件

```css
/* 移动端原生弹窗 */
.mobile-*-overlay {
  z-index: 10000 !important;
  /* 提高z-index确保在移动端侧边栏上方显示 */
}
```

## 修复的组件列表

### 1. 侧边栏组件 (`src/components/Sidebar.vue`)

- 降低侧边栏容器z-index: 10001 → 9000
- 调整关闭按钮z-index: 10002 → 9001
- 降低遮罩层z-index: 9998 → 8999

### 2. 股票交易弹窗 (`src/components/StockTradingDialog.vue`)

- 添加Element Plus弹窗z-index设置
- 设置dialog z-index: 10000
- 设置overlay z-index: 9999

### 3. 移动端股票交易弹窗 (`src/components/MobileStockTradingDialog.vue`)

- 提高原生弹窗z-index: 9999 → 10000

### 4. AI交易弹窗 (`src/components/AITradingDialog.vue`)

- 添加Element Plus弹窗z-index设置
- 设置dialog z-index: 10000
- 设置overlay z-index: 9999

### 5. 投资偏好弹窗 (`src/components/InvestmentPreferencesDialog.vue`)

- 调整dialog z-index: 9999 → 10000
- 调整overlay z-index: 9998 → 9999
- 调整弹窗容器z-index: 10000 → 10001

### 6. 移动端快捷操作弹窗 (`src/components/MobileShortcutsDialog.vue`)

- 提高弹窗z-index: 9999 → 10000

### 7. 主页面弹窗 (`src/views/Main.vue`)

- 快捷操作遮罩层: 9999 → 10000
- 用户菜单遮罩层: 10000 → 10001

### 8. 用户资料弹窗 (`src/components/UserProfile.vue`)

- 充值弹窗遮罩层: 10001 → 10002
- 设置弹窗遮罩层: 3000 → 10000
- 字段编辑弹窗遮罩层: 3100 → 10001

### 9. 记录中心弹窗 (`src/components/RecordsCenter.vue`)

- 记录弹窗遮罩层: 1000 → 10000

## 最终层级规范

### 标准z-index层级

| 组件类型     | z-index范围 | 说明                 |
| ------------ | ----------- | -------------------- |
| 页面基础元素 | 1-99        | 导航栏、内容区域等   |
| 悬浮元素     | 100-999     | 悬浮按钮、提示等     |
| 侧边栏       | 9000-9001   | 移动端侧边栏及其控件 |
| 侧边栏遮罩   | 8999        | 侧边栏背景遮罩       |
| 弹窗遮罩     | 9999        | 弹窗背景遮罩         |
| 普通弹窗     | 10000       | 大部分弹窗内容       |
| 重要弹窗     | 10001+      | 用户菜单、系统设置等 |

### 设计原则

1. **侧边栏层级低于弹窗**：确保从侧边栏触发的弹窗能正常显示
2. **遮罩层级低于内容**：确保弹窗内容在遮罩之上
3. **重要弹窗层级更高**：系统级弹窗优先级最高
4. **预留层级空间**：避免层级冲突，便于后续扩展

## 测试验证

修复后需要验证以下场景：

1. ✅ 移动端侧边栏中的"买入"按钮弹窗正常显示
2. ✅ 移动端侧边栏中的"卖出"按钮弹窗正常显示
3. ✅ 移动端侧边栏中的"AI交易"按钮弹窗正常显示
4. ✅ 移动端侧边栏中的"量化分析"按钮弹窗正常显示
5. ✅ 移动端侧边栏中的其他操作按钮弹窗正常显示
6. ✅ 侧边栏本身的显示和隐藏功能正常
7. ✅ 其他页面的弹窗功能不受影响

## 总结

通过系统性地调整z-index层级，解决了移动端侧边栏弹窗被遮挡的问题。核心思路是：

1. **降低侧边栏层级**：让侧边栏不再遮挡弹窗
2. **统一弹窗标准**：所有弹窗使用统一的高层级z-index
3. **建立层级规范**：为未来的组件开发提供明确的层级指导

这次修复不仅解决了当前问题，还建立了完整的z-index管理规范，避免类似问题再次发生。
